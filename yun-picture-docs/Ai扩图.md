# Aiæ‰©å›¾

# éœ€æ±‚åˆ†æ

### éœ€æ±‚åˆ†æ

éšç€ AIØœ çš„é«˜é€Ÿå‘å±•ï¼ŒAI å‡ ä¹å¯ä»¥åº”ç”¨åˆ°ä»»ä½•ä¼ ç»Ÿä¸šåŠ¡ä¸­ï¼Œå¢å¼ºåº”ç”¨çš„åŠŸèƒ½ï¼Œå¸¦ç»™ç”¨æˆ·æ›´å¥½çš„ä½“éªŒã€‚

å¯¹äºå›¾åº“ç½‘ç«™Øœæ¥è¯´ï¼ŒAI ä¹Ÿæœ‰éå¸¸å¤šçš„åº”ç”¨ç©ºé—´ï¼Œæ¯”å¦‚å¯ä»¥åˆ©ç”¨ AI ç»˜å›¾å¤§æ¨¡å‹æ¥ç¼–è¾‘å›¾ç‰‡ï¼Œå®ç°æ‰©å›¾ã€æ“¦é™¤è¡¥å…¨ã€å›¾é…æ–‡ã€å»æ°´å°ç­‰åŠŸèƒ½ã€‚

ä»¥ AI æ‰©å›¾åŠŸØœèƒ½ä¸ºä¾‹ï¼Œè®©æˆ‘ä»¬æ¥å­¦ä¹ å¦‚ä½•åœ¨é¡¹ç›®ä¸­å¿«é€Ÿæ¥å…¥ AI ç»˜å›¾å¤§æ¨¡å‹ã€‚ç”¨æˆ·å¯ä»¥é€‰æ‹©ä¸€å¼ å·²ä¸Šä¼ çš„å›¾ç‰‡ï¼Œé€šè¿‡ AI ç¼–è¾‘å¾—åˆ°æ–°çš„å›¾ç‰‡ï¼Œå¹¶æ ¹æ®æƒ…å†µè‡ªè¡Œé€‰æ‹©æ˜¯å¦ä¿å­˜ã€‚

# æ–¹æ¡ˆè®¾è®¡

## Aiç»˜å›¾å¤§æ¨¡å‹é€‰æ‹©

AI ç»˜å›¾Øœå¤§æ¨¡å‹æˆ‘ä»¬è‡ªå·±æ˜¯æä¸æ¥çš„ï¼Œå¯ä»¥é€‰æ‹©ä¸€ä¸ªå¸‚é¢ä¸Šæ”¯æŒ AI ç»˜å›¾çš„å¤§æ¨¡å‹ã€‚

é€‰æ‹© AI Øœå¤§æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬æœ€å…³æ³¨çš„åº”è¯¥æ˜¯ç”Ÿæˆæ•ˆæœã€ç”Ÿæˆé€Ÿåº¦è¿˜æœ‰ä»·æ ¼äº†å§ï¼Ÿå½“ç„¶ï¼Œå¯¹æˆ‘ä»¬å­¦ä¹ æ¥è¯´ï¼Œæœ€å…³æ³¨çš„è¿˜æ˜¯ä»·æ ¼ï¼Œæ¯•ç«Ÿç»˜ç”»å¤§æ¨¡å‹çš„è´¹ç”¨ä¸ä½ã€‚

å›½å¤–æ¯”è¾ƒçŸ¥åçš„å°±æ˜¯ Midjourneyï¼Œä¸è¿‡ä¸ä»…å¼€å‘å¯¹æ¥éº»çƒ¦ï¼Œä»·æ ¼ä¹Ÿæ¯”è¾ƒè´µã€‚å›½å†…çš„ AI ç»˜å›¾å¤§æ¨¡å‹æ¯”è¾ƒæ¨è [é˜¿é‡Œäº‘ç™¾ç‚¼](https://click.aliyun.com/m/1000400273/) ï¼Œå®ƒæ˜¯ä¸€ç«™å¼çš„å¤§æ¨¡å‹å¼€å‘åŠåº”ç”¨æ„å»ºå¹³å°ï¼Œå¯ä»¥é€šè¿‡ç®€å•çš„ç•Œé¢æ“ä½œï¼Œåœ¨ 5 åˆ†é’Ÿå†…å¼€å‘å‡ºä¸€æ¬¾å¤§æ¨¡å‹åº”ç”¨ï¼Œå¹¶åœ¨çº¿ä½“éªŒæ•ˆæœã€‚

![](assets/NZlmbuAVyokyXkxdQsLcq6hfnxc.png)

åˆ›å»ºå¥½åº”ç”¨Øœåï¼Œåˆ©ç”¨å®˜æ–¹æä¾›çš„ API æˆ– SDKï¼Œç›´æ¥é€šè¿‡å‡ è¡Œä»£ç ï¼Œå°±èƒ½åœ¨é¡¹ç›®ä¸­ä½¿ç”¨å¤§æ¨¡å‹åº”ç”¨ï¼š

![](assets/EcJJb0bEvoM8eTx7MzmcBgY5ngc.png)

é€šè¿‡é˜…è¯»æ–‡æ¡£å‘ç°ï¼Œæ˜¯æ”¯æŒaiæ‰©å›¾çš„ï¼Œå…è´¹é¢åº¦åªæœ‰500å¼ ï¼Œä¸è¿‡ç”¨äºå­¦ä¹ æ˜¯å¤Ÿç”¨äº†

![](assets/ROZrbUvgWowxSTx3cIKcuVhenDc.png)

## è°ƒç”¨æ–¹å¼

é€šè¿‡é˜…è¯» [AI å›¾åƒæ‰©å±•çš„å®˜æ–¹æ–‡æ¡£](https://click.aliyun.com/m/1000400274/)ï¼Œæˆ‘ä»¬å‘ç°ï¼ŒAPI åªæ”¯æŒå¼‚æ­¥æ–¹å¼è°ƒç”¨ã€‚

![](assets/MGr2bYcqUolixCxqFUfclLw8nPh.png)

è¿™æ˜¯å› ä¸º AI ç»˜ç”»ä»»åŠ¡è®¡Øœç®—é‡å¤§ä¸”è€—æ—¶é•¿ï¼ŒåŒæ­¥è°ƒç”¨ä¼šå¯¼è‡´æœåŠ¡å™¨çº¿ç¨‹é•¿æ—¶é—´è¢«å•ä¸ªä»»åŠ¡å ç”¨ï¼Œé™åˆ¶äº†å¹¶å‘å¤„ç†èƒ½åŠ›ï¼Œå¢åŠ äº†è¶…æ—¶å’Œç³»ç»Ÿå´©æºƒçš„é£é™©ã€‚é€šè¿‡å¼‚æ­¥è°ƒç”¨ï¼ŒæœåŠ¡å™¨å¯ä»¥å°†ä»»åŠ¡æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œåˆç†è°ƒåº¦èµ„æºï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ï¼Œä»è€Œæ›´é«˜æ•ˆåœ°æœåŠ¡å¤šä¸ªç”¨æˆ·è¯·æ±‚ï¼Œæå‡æ•´ä½“ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯æ‰©å±•æ€§ã€‚

ç”±äº AI æ¥å£Øœå·²ç»é€‰æ‹©äº†å¼‚æ­¥è°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½œä¸ºè¦è°ƒç”¨ AI æ¥å£çš„å®¢æˆ·ç«¯ï¼Œè¦ä½¿ç”¨è½®è¯¢çš„æ–¹å¼æ¥æ£€æŸ¥ä»»åŠ¡çŠ¶æ€æ˜¯å¦ä¸º â€œå·²å®Œæˆâ€ï¼Œå¦‚æœå®Œæˆäº†ï¼Œæ‰å¯ä»¥è·å–åˆ°ç”Ÿæˆçš„å›¾ç‰‡ã€‚

**é‚£ä¹ˆæ˜¯å‰ç«¯è½®è¯¢è¿˜æ˜¯åç«¯è½®è¯¢å‘¢ï¼Ÿ**

1. å‰ç«¯è½®è¯¢

å‰ç«¯è°ƒç”¨åØœç«¯æäº¤ä»»åŠ¡åå¾—åˆ°ä»»åŠ¡ IDï¼Œç„¶åé€šè¿‡å®šæ—¶å™¨è½®è¯¢è¯·æ±‚æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€æ¥å£ï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆæˆ–å¤±è´¥ã€‚ç¤ºä¾‹ä»£ç ï¼š


```JavaScript
// æäº¤ä»»åŠ¡
async function submitTask() {
  const response = await fetch('/api/createTask', { method: 'POST' });
  const { taskId } = await response.json();
  checkTaskStatus(taskId);
}

// è°ƒç”¨
submitTask();

// æ£€æŸ¥ä»»åŠ¡çŠ¶æ€
async function checkTaskStatus(taskId) {
  const intervalId = setInterval(async () => {
    const response = await fetch(`/api/taskStatus?taskId=${taskId}`);
    const { status, result } = await response.json();

    if (status === 'success') {
      console.log('Task completed:', result);
      clearInterval(intervalId); // åœæ­¢è½®è¯¢
    } else if (status === 'failed') {
      console.error('Task failed');
      clearInterval(intervalId); // åœæ­¢è½®è¯¢
    }
  }, 2000); // æ¯éš” 2 ç§’è½®è¯¢
}

```

1. åç«¯è½®è¯¢

åç«¯é€šè¿‡å¾ªØœç¯æˆ–å®šæ—¶ä»»åŠ¡æ£€æµ‹ä»»åŠ¡çŠ¶æ€ï¼Œæ¥å£ä¿æŒé˜»å¡ï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆæˆ–å¤±è´¥ï¼Œç›´æ¥è¿”å›ç»“æœç»™å‰ç«¯ã€‚ç¤ºä¾‹ä»£ç ï¼š


```Java
@RestController
public class TaskController {

    @PostMapping("/createTask")
    public String createTask() {
        String taskId = taskService.submitTask();
        return taskId;
    }

    @GetMapping("/waitForTask")
    public ResponseEntity<String> waitForTask(@RequestParam String taskId) {
        while (true) {
            String status = taskService.checkTaskStatus(taskId);

            if ("success".equals(status)) {
                return ResponseEntity.ok("Task completed");
            } else if ("failed".equals(status)) {
                return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body("Task failed");
            }

            try {
                Thread.sleep(2000); // ç­‰å¾… 2 ç§’åé‡è¯•
            } catch (InterruptedException e) {
                return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body("Error occurred");
            }
        }
    }
}

```

æ˜¾ç„¶ï¼Œåç«¯è½®è¯¢å®¹æ˜“å› ä¸ºä»»åŠ¡é˜»å¡å¯¼è‡´èµ„æºè€—å°½ï¼Œæ‰€ä»¥é€šå¸¸æ¨è å‰ç«¯è½®è¯¢ã€‚é™¤éæœ‰æ˜ç¡®çš„éœ€æ±‚è¦æ±‚æ—¶ï¼Œæ‰è€ƒè™‘åç«¯è½®è¯¢ï¼Œæ¯”å¦‚ä»»åŠ¡ç»“æœéœ€å®æ—¶è¿”å›ä¸”å¯¹ç½‘ç»œè¯·æ±‚æ•°æ•æ„Ÿã€‚ï¼ˆæˆ–è€…å­¦ä¹ æ—¶ä¸æƒ³å†™å‰ç«¯ï¼‰

æ­¤å¤„æˆ‘ä»¬ä¹Ÿé€‰æ‹©å‰ç«¯è½®è¯¢æ–¹æ¡ˆå®ç°ã€‚

ğŸ’¡ ä»è¿™ä¸ªæ–¹æ¡ˆè®¾è®¡Øœä¸­ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½æ„Ÿå—åˆ°ï¼Œå¦‚æœä½ åŒæ—¶äº†è§£å‰ç«¯å’Œåç«¯ï¼Œå¯ä»¥ç»“åˆäºŒè€…è®¾è®¡å‡ºæ›´åˆç†çš„æ–¹æ¡ˆï¼Œè€Œä¸æ˜¯æŠŠæ‰€æœ‰çš„ â€œé‡æ‹…â€ éƒ½äº¤ç»™å‰ç«¯æˆ–è€…åç«¯ä¸€æ–¹ã€‚æ‰€ä»¥ä¼ä¸šä¸­å¼€éœ€æ±‚è¯„å®¡ä¼šæˆ–è€…è®¨è®ºæ–¹æ¡ˆæ—¶ï¼Œå‰åç«¯éœ€è¦ç´§å¯†åä½œã€‚

ä¸‹é¢è¿›å…¥å¼€å‘ã€‚

# åç«¯å¼€å‘

## è·å–Aiæ‰©å›¾API

é¦–å…ˆå¼€å‘ä¸šåŠ¡ä¾èµ–çš„åŸºç¡€èƒ½åŠ›ï¼Œä¹Ÿå°±æ˜¯ AI æ‰©å›¾ APIã€‚

1. éœ€è¦å…ˆè¿›å…¥ [é˜¿é‡Œäº‘ç™¾ç‚¼æ§åˆ¶å°](https://click.aliyun.com/m/1000400275/) å¼€é€šæœåŠ¡ï¼š

![](assets/GCypbTJMPoqwcQxw9gWcs9pWnRd.png)

1. å¼€é€šä¹‹åï¼Œæˆ‘ä»¬è¦åœ¨æ§åˆ¶å°è·å– API Keyï¼Œå¯ [å‚è€ƒæ–‡æ¡£](https://click.aliyun.com/m/1000400408/)

èƒ½å¤Ÿåœ¨æ§åˆ¶Øœå°æŸ¥çœ‹åˆ° API Keyï¼Œæ³¨æ„ï¼ŒAPI Key ä¸€å®šä¸è¦å¯¹å¤–æ³„éœ²ï¼

é€šè¿‡é˜…è¯»æ–‡æ¡£å‘ç°ï¼Œç™¾ç‚¼æ”¯æŒé€šè¿‡ SDK æˆ– HTTP è°ƒç”¨ã€‚è™½ç„¶å®˜æ–¹å†™çš„æ”¯æŒ Java SDKï¼Œä½† AI æ‰©å›¾åŠŸèƒ½ä¸­å¯¹ SDK çš„ä»‹ç»éå¸¸å°‘ï¼Œæ­¤å¤„è€ƒè™‘åˆ°å…¼å®¹æ€§ï¼Œæˆ‘ä»¬è¿˜æ˜¯ ä½¿ç”¨ HTTP è°ƒç”¨ã€‚

1. åœ¨é…ç½®æ–‡ä»¶ä¸­å¡«å†™è·å–åˆ°çš„ apiKeyï¼š


```YAML
# é˜¿é‡Œäº‘ AI é…ç½®
aliYunAi:
    apiKey: xxxx
```

1. æ–°å»ºæ•°æ®æ¨¡å‹ç±»

åœ¨ `api` åŒ…ä¸‹æ–°å»º `aliyunai` åŒ…ï¼Œå­˜æ”¾é˜¿é‡Œäº‘ AI ç›¸å…³ä»£ç ã€‚

åœ¨ `aliyunai.model` åŒ…ä¸‹æ–°å»ºæ•°æ®æ¨¡å‹ç±»ï¼Œå¯ä»¥è®© AI æ ¹æ®å®˜æ–¹æ–‡æ¡£ä¸­çš„è¯·æ±‚å“åº”ä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆï¼Œæ— éœ€è‡ªå·±æ‰‹åŠ¨ç¼–å†™ã€‚

ç”±äºæ¯ä¸ª ØœAI å›¾ç‰‡å¤„ç†æ“ä½œçš„è¯·æ±‚å“åº”éƒ½æœ‰ä¸€äº›åŒºåˆ«ï¼Œæ‰€ä»¥å•ç‹¬ç»™ AI æ‰©å›¾åŠŸèƒ½ç¼–å†™å…·ä½“çš„è¯·æ±‚å“åº”ç±»ã€‚

åˆ›å»ºæ‰©å›¾ä»»åŠ¡è¯·æ±‚ç±»ï¼š


```Java
@Datapublic class CreateOutPaintingTaskRequest implements Serializable {

    /**
     * æ¨¡å‹ï¼Œä¾‹å¦‚ "image-out-painting"
     */private String model = "image-out-painting";

    /**
     * è¾“å…¥å›¾åƒä¿¡æ¯
     */private Input input;

    /**
     * å›¾åƒå¤„ç†å‚æ•°
     */private Parameters parameters;

    @Datapublic static class Input {
        /**
         * å¿…é€‰ï¼Œå›¾åƒ URL
         */@Alias("image_url")private String imageUrl;
    }

    @Datapublic static class Parameters implements Serializable {
        /**
         * å¯é€‰ï¼Œé€†æ—¶é’ˆæ—‹è½¬è§’åº¦ï¼Œé»˜è®¤å€¼ 0ï¼Œå–å€¼èŒƒå›´ [0, 359]
         */private Integer angle;

        /**
         * å¯é€‰ï¼Œè¾“å‡ºå›¾åƒçš„å®½é«˜æ¯”ï¼Œé»˜è®¤ç©ºå­—ç¬¦ä¸²ï¼Œä¸è®¾ç½®å®½é«˜æ¯”
         * å¯é€‰å€¼ï¼š["", "1:1", "3:4", "4:3", "9:16", "16:9"]
         */@Alias("output_ratio")private String outputRatio;

        /**
         * å¯é€‰ï¼Œå›¾åƒå±…ä¸­ï¼Œåœ¨æ°´å¹³æ–¹å‘ä¸ŠæŒ‰æ¯”ä¾‹æ‰©å±•ï¼Œé»˜è®¤å€¼ 1.0ï¼ŒèŒƒå›´ [1.0, 3.0]
         */@Alias("x_scale")@JsonProperty("xScale")private Float xScale;

        /**
         * å¯é€‰ï¼Œå›¾åƒå±…ä¸­ï¼Œåœ¨å‚ç›´æ–¹å‘ä¸ŠæŒ‰æ¯”ä¾‹æ‰©å±•ï¼Œé»˜è®¤å€¼ 1.0ï¼ŒèŒƒå›´ [1.0, 3.0]
         */@Alias("y_scale")@JsonProperty("yScale")private Float yScale;

        /**
         * å¯é€‰ï¼Œåœ¨å›¾åƒä¸Šæ–¹æ·»åŠ åƒç´ ï¼Œé»˜è®¤å€¼ 0
         */@Alias("top_offset")private Integer topOffset;

        /**
         * å¯é€‰ï¼Œåœ¨å›¾åƒä¸‹æ–¹æ·»åŠ åƒç´ ï¼Œé»˜è®¤å€¼ 0
         */@Alias("bottom_offset")private Integer bottomOffset;

        /**
         * å¯é€‰ï¼Œåœ¨å›¾åƒå·¦ä¾§æ·»åŠ åƒç´ ï¼Œé»˜è®¤å€¼ 0
         */@Alias("left_offset")private Integer leftOffset;

        /**
         * å¯é€‰ï¼Œåœ¨å›¾åƒå³ä¾§æ·»åŠ åƒç´ ï¼Œé»˜è®¤å€¼ 0
         */@Alias("right_offset")private Integer rightOffset;

        /**
         * å¯é€‰ï¼Œå¼€å¯å›¾åƒæœ€ä½³è´¨é‡æ¨¡å¼ï¼Œé»˜è®¤å€¼ false
         * è‹¥ä¸º trueï¼Œè€—æ—¶ä¼šæˆå€å¢åŠ 
         */@Alias("best_quality")private Boolean bestQuality;

        /**
         * å¯é€‰ï¼Œé™åˆ¶æ¨¡å‹ç”Ÿæˆçš„å›¾åƒæ–‡ä»¶å¤§å°ï¼Œé»˜è®¤å€¼ true
         * - å•è¾¹é•¿åº¦ <= 10000ï¼šè¾“å‡ºå›¾åƒæ–‡ä»¶å¤§å°é™åˆ¶ä¸º 5MB ä»¥ä¸‹
         * - å•è¾¹é•¿åº¦ > 10000ï¼šè¾“å‡ºå›¾åƒæ–‡ä»¶å¤§å°é™åˆ¶ä¸º 10MB ä»¥ä¸‹
         */@Alias("limit_image_size")private Boolean limitImageSize;

        /**
         * å¯é€‰ï¼Œæ·»åŠ  "Generated by AI" æ°´å°ï¼Œé»˜è®¤å€¼ true
         */@Alias("add_watermark")private Boolean addWatermark = false;
    }
}
```

æ³¨æ„ï¼Œä¸Šè¿°ä»£ç ä¸­ï¼ŒæŸäº›å­—æ®µæ‰“ä¸Šäº† Hutool å·¥å…·ç±»çš„ `@Alias` æ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£ä»…å¯¹ Hutool çš„ JSON è½¬æ¢ç”Ÿæ•ˆï¼Œå¯¹ SpringMVC çš„ JSON è½¬æ¢æ²¡æœ‰ä»»ä½•å½±å“ã€‚

ğŸ’¡ è¿™é‡Œæœ‰ä¸€ä¸ªå·¨å‘çš„åœ°æ–¹ï¼ç»è¿‡æµ‹è¯•å‘ç°ï¼Œå‰ç«¯å¦‚æœä¼ é€’å‚æ•°å xScaleï¼Œæ˜¯æ— æ³•èµ‹å€¼ç»™ xScale å­—æ®µçš„ï¼›ä½†æ˜¯ä¼ é€’å‚æ•°å xscaleï¼Œå°±å¯ä»¥èµ‹å€¼ã€‚è¿™æ˜¯å› ä¸º SpringMVC å¯¹äºç¬¬äºŒä¸ªå­—æ¯æ˜¯å¤§å†™çš„å‚æ•°æ— æ³•æ˜ å°„ï¼ˆå’Œå‚æ•°ç±»åˆ«æ— å…³ï¼‰ï¼Œ[å‚è€ƒåšå®¢](https://blog.csdn.net/JokerHH/article/details/88729590)ã€‚

è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œç»™è¿™äº›å­—æ®µå¢åŠ  `@JsonProperty` æ³¨è§£ï¼š


```Java
/**
 * å¯é€‰ï¼Œå›¾åƒå±…ä¸­ï¼Œåœ¨æ°´å¹³æ–¹å‘ä¸ŠæŒ‰æ¯”ä¾‹æ‰©å±•ï¼Œé»˜è®¤å€¼ 1.0ï¼ŒèŒƒå›´ [1.0, 3.0]
 */@Alias("x_scale")
 @JsonProperty("xScale")
 private Float xScale;

/**
 * å¯é€‰ï¼Œå›¾åƒå±…ä¸­ï¼Œåœ¨å‚ç›´æ–¹å‘ä¸ŠæŒ‰æ¯”ä¾‹æ‰©å±•ï¼Œé»˜è®¤å€¼ 1.0ï¼ŒèŒƒå›´ [1.0, 3.0]
 */
 @Alias("y_scale")
 @JsonProperty("yScale")
 private Float yScale;
```

ä¸ºä»€ä¹ˆ SpringMVC è¦è¿™æ ·è®¾è®¡å‘¢ï¼Ÿè¿™æ˜¯å› ä¸º Jackson åœ¨å¤„ç†å­—æ®µåä¸ JSON å±æ€§åæ˜ å°„æ—¶ï¼Œä¼šä¾èµ– Java çš„ æ ‡å‡†å‘½åè§„èŒƒ å’Œ åå°„ APIã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œæ ¹æ® JavaBean çš„è§„èŒƒï¼Œå±æ€§åç§°ä¸å…¶è®¿é—®å™¨æ–¹æ³•ï¼ˆgetter å’Œ setterï¼‰ä¹‹é—´çš„æ˜ å°„è§„åˆ™æ˜¯ï¼šå¦‚æœå±æ€§åä»¥å°å†™å­—æ¯å¼€å¤´ï¼Œç¬¬äºŒä¸ªå­—æ¯æ˜¯å¤§å†™ï¼ˆå¦‚ `eMail`ï¼‰ï¼Œè§„èŒƒä»è®¤ä¸ºå±æ€§åç§°æ˜¯ `eMail`ï¼Œè€Œè®¿é—®å™¨æ–¹æ³•åº”ä¸º `geteMail()` å’Œ `seteMail()`ã€‚ä½† Jackson ä¼šå°è¯•æ¨æ–­å±æ€§åä¸º `email`ï¼ˆå› ä¸º `eMail` ä¸å¸¸è§ï¼‰ï¼Œä»è€Œå¯¼è‡´ JSON ä¸­ `eMail` æˆ– `email` å¯èƒ½æ— æ³•æ­£ç¡®æ˜ å°„ã€‚

åˆ›å»ºæ‰©å›¾ä»»åŠ¡å“åº”ç±»ï¼š


```Java
@Data
@NoArgsConstructor
@AllArgsConstructor
public class CreateOutPaintingTaskResponse {

    private Output output;

    /**
     * è¡¨ç¤ºä»»åŠ¡çš„è¾“å‡ºä¿¡æ¯
     */@Datapublic static class Output {

        /**
         * ä»»åŠ¡ ID
         */private String taskId;

        /**
         * ä»»åŠ¡çŠ¶æ€
         * <ul>
         *     <li>PENDINGï¼šæ’é˜Ÿä¸­</li>
         *     <li>RUNNINGï¼šå¤„ç†ä¸­</li>
         *     <li>SUSPENDEDï¼šæŒ‚èµ·</li>
         *     <li>SUCCEEDEDï¼šæ‰§è¡ŒæˆåŠŸ</li>
         *     <li>FAILEDï¼šæ‰§è¡Œå¤±è´¥</li>
         *     <li>UNKNOWNï¼šä»»åŠ¡ä¸å­˜åœ¨æˆ–çŠ¶æ€æœªçŸ¥</li>
         * </ul>
         */private String taskStatus;
    }

    /**
     * æ¥å£é”™è¯¯ç ã€‚
     * <p>æ¥å£æˆåŠŸè¯·æ±‚ä¸ä¼šè¿”å›è¯¥å‚æ•°ã€‚</p>
     */private String code;

    /**
     * æ¥å£é”™è¯¯ä¿¡æ¯ã€‚
     * <p>æ¥å£æˆåŠŸè¯·æ±‚ä¸ä¼šè¿”å›è¯¥å‚æ•°ã€‚</p>
     */private String message;

    /**
     * è¯·æ±‚å”¯ä¸€æ ‡è¯†ã€‚
     * <p>å¯ç”¨äºè¯·æ±‚æ˜ç»†æº¯æºå’Œé—®é¢˜æ’æŸ¥ã€‚</p>
     */private String requestId;

}
```

æŸ¥è¯¢ä»»åŠ¡å“åº”ç±»ï¼š


```Java
@Data
@NoArgsConstructor
@AllArgsConstructorpublic 
class GetOutPaintingTaskResponse {

    /**
     * è¯·æ±‚å”¯ä¸€æ ‡è¯†
     */private String requestId;

    /**
     * è¾“å‡ºä¿¡æ¯
     */private Output output;

    /**
     * è¡¨ç¤ºä»»åŠ¡çš„è¾“å‡ºä¿¡æ¯
     */@Datapublic static class Output {

        /**
         * ä»»åŠ¡ ID
         */private String taskId;

        /**
         * ä»»åŠ¡çŠ¶æ€
         * <ul>
         *     <li>PENDINGï¼šæ’é˜Ÿä¸­</li>
         *     <li>RUNNINGï¼šå¤„ç†ä¸­</li>
         *     <li>SUSPENDEDï¼šæŒ‚èµ·</li>
         *     <li>SUCCEEDEDï¼šæ‰§è¡ŒæˆåŠŸ</li>
         *     <li>FAILEDï¼šæ‰§è¡Œå¤±è´¥</li>
         *     <li>UNKNOWNï¼šä»»åŠ¡ä¸å­˜åœ¨æˆ–çŠ¶æ€æœªçŸ¥</li>
         * </ul>
         */private String taskStatus;

        /**
         * æäº¤æ—¶é—´
         * æ ¼å¼ï¼šYYYY-MM-DD HH:mm:ss.SSS
         */private String submitTime;

        /**
         * è°ƒåº¦æ—¶é—´
         * æ ¼å¼ï¼šYYYY-MM-DD HH:mm:ss.SSS
         */private String scheduledTime;

        /**
         * ç»“æŸæ—¶é—´
         * æ ¼å¼ï¼šYYYY-MM-DD HH:mm:ss.SSS
         */private String endTime;

        /**
         * è¾“å‡ºå›¾åƒçš„ URL
         */private String outputImageUrl;

        /**
         * æ¥å£é”™è¯¯ç 
         * <p>æ¥å£æˆåŠŸè¯·æ±‚ä¸ä¼šè¿”å›è¯¥å‚æ•°</p>
         */private String code;

        /**
         * æ¥å£é”™è¯¯ä¿¡æ¯
         * <p>æ¥å£æˆåŠŸè¯·æ±‚ä¸ä¼šè¿”å›è¯¥å‚æ•°</p>
         */private String message;

        /**
         * ä»»åŠ¡æŒ‡æ ‡ä¿¡æ¯
         */private TaskMetrics taskMetrics;
    }

    /**
     * è¡¨ç¤ºä»»åŠ¡çš„ç»Ÿè®¡ä¿¡æ¯
     */@Datapublic static class TaskMetrics {

        /**
         * æ€»ä»»åŠ¡æ•°
         */private Integer total;

        /**
         * æˆåŠŸä»»åŠ¡æ•°
         */private Integer succeeded;

        /**
         * å¤±è´¥ä»»åŠ¡æ•°
         */private Integer failed;
    }
}
```

5ï¼‰å¼€å‘ ØœAPI è°ƒç”¨ç±»ï¼Œé€šè¿‡ Hutool çš„ HTTP è¯·æ±‚å·¥å…·ç±»æ¥è°ƒç”¨é˜¿é‡Œäº‘ç™¾ç‚¼çš„ APIï¼š


```Java
@Slf4j@Componentpublic class AliYunAiApi {
    // è¯»å–é…ç½®æ–‡ä»¶@Value("${aliYunAi.apiKey}")private String apiKey;

    // åˆ›å»ºä»»åŠ¡åœ°å€public static final String CREATE_OUT_PAINTING_TASK_URL = "https://dashscope.aliyuncs.com/api/v1/services/aigc/image2image/out-painting";

    // æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€public static final String GET_OUT_PAINTING_TASK_URL = "https://dashscope.aliyuncs.com/api/v1/tasks/%s";

    /**
     * åˆ›å»ºä»»åŠ¡
     *
     * @param createOutPaintingTaskRequest
     * @return
     */public CreateOutPaintingTaskResponse createOutPaintingTask(CreateOutPaintingTaskRequest createOutPaintingTaskRequest) {
        if (createOutPaintingTaskRequest == null) {
            throw new BusinessException(ErrorCode.OPERATION_ERROR, "æ‰©å›¾å‚æ•°ä¸ºç©º");
        }
        // å‘é€è¯·æ±‚HttpRequest httpRequest = HttpRequest.post(CREATE_OUT_PAINTING_TASK_URL)
                .header(Header.AUTHORIZATION, "Bearer " + apiKey)
                // å¿…é¡»å¼€å¯å¼‚æ­¥å¤„ç†ï¼Œè®¾ç½®ä¸ºenableã€‚
                .header("X-DashScope-Async", "enable")
                .header(Header.CONTENT_TYPE, ContentType.JSON.getValue())
                .body(JSONUtil.toJsonStr(createOutPaintingTaskRequest));
        try (HttpResponse httpResponse = httpRequest.execute()) {
            if (!httpResponse.isOk()) {
                log.error("è¯·æ±‚å¼‚å¸¸ï¼š{}", httpResponse.body());
                throw new BusinessException(ErrorCode.OPERATION_ERROR, "AI æ‰©å›¾å¤±è´¥");
            }
            CreateOutPaintingTaskResponse response = JSONUtil.toBean(httpResponse.body(), CreateOutPaintingTaskResponse.class);
            String errorCode = response.getCode();
            if (StrUtil.isNotBlank(errorCode)) {
                String errorMessage = response.getMessage();
                log.error("AI æ‰©å›¾å¤±è´¥ï¼ŒerrorCode:{}, errorMessage:{}", errorCode, errorMessage);
                throw new BusinessException(ErrorCode.OPERATION_ERROR, "AI æ‰©å›¾æ¥å£å“åº”å¼‚å¸¸");
            }
            return response;
        }
    }

    /**
     * æŸ¥è¯¢åˆ›å»ºçš„ä»»åŠ¡
     *
     * @param taskId
     * @return
     */public GetOutPaintingTaskResponse getOutPaintingTask(String taskId) {
        if (StrUtil.isBlank(taskId)) {
            throw new BusinessException(ErrorCode.OPERATION_ERROR, "ä»»åŠ¡ id ä¸èƒ½ä¸ºç©º");
        }
        try (HttpResponse httpResponse = HttpRequest.get(String.format(GET_OUT_PAINTING_TASK_URL, taskId))
                .header(Header.AUTHORIZATION, "Bearer " + apiKey)
                .execute()) {
            if (!httpResponse.isOk()) {
                throw new BusinessException(ErrorCode.OPERATION_ERROR, "è·å–ä»»åŠ¡å¤±è´¥");
            }
            return JSONUtil.toBean(httpResponse.body(), GetOutPaintingTaskResponse.class);
        }
    }
}
```

æ³¨æ„ï¼Œè¦æŒ‰Øœç…§å®˜æ–¹æ–‡æ¡£çš„è¦æ±‚ç»™è¯·æ±‚å¤´å¢åŠ é‰´æƒä¿¡æ¯ï¼Œæ‹¼æ¥é…ç½®ä¸­å†™å¥½çš„ apiKey

## æ‰©å›¾æœåŠ¡

åœ¨ `model.dto.picture` åŒ…ä¸‹æ–°å»º AI æ‰©å›¾è¯·æ±‚ç±»ï¼Œç”¨äºæ¥å—å‰ç«¯ä¼ æ¥çš„å‚æ•°å¹¶ä¼ é€’ç»™ Service æœåŠ¡å±‚ã€‚å­—æ®µåŒ…æ‹¬å›¾ç‰‡ id å’Œæ‰©å›¾å‚æ•°ï¼š


```Java
@Datapublic class CreatePictureOutPaintingTaskRequest implements Serializable {

    /**
     * å›¾ç‰‡ id
     */private Long pictureId;

    /**
     * æ‰©å›¾å‚æ•°
     */private CreateOutPaintingTaskRequest.Parameters parameters;

    private static final long serialVersionUID = 1L;
}
```

åœ¨å›¾ç‰‡æœåŠ¡ä¸­ç¼–å†™åˆ›Øœå»ºæ‰©å›¾ä»»åŠ¡æ–¹æ³•ï¼Œä»æ•°æ®åº“ä¸­è·å–å›¾ç‰‡ä¿¡æ¯å’Œ url åœ°å€ï¼Œæ„é€ è¯·æ±‚å‚æ•°åè°ƒç”¨ api åˆ›å»ºæ‰©å›¾ä»»åŠ¡ã€‚æ³¨æ„ï¼Œå¦‚æœå›¾ç‰‡æœ‰ç©ºé—´ idï¼Œåˆ™éœ€è¦æ ¡éªŒæƒé™ï¼Œç›´æ¥å¤ç”¨ä»¥å‰çš„æƒé™æ ¡éªŒæ–¹æ³•ã€‚


```Java
@Overridepublic CreateOutPaintingTaskResponse createPictureOutPaintingTask(CreatePictureOutPaintingTaskRequest createPictureOutPaintingTaskRequest, User loginUser) {
    // è·å–å›¾ç‰‡ä¿¡æ¯Long pictureId = createPictureOutPaintingTaskRequest.getPictureId();
    Picture picture = Optional.ofNullable(this.getById(pictureId))
            .orElseThrow(() -> new BusinessException(ErrorCode.NOT_FOUND_ERROR));
    // æƒé™æ ¡éªŒ
    checkPictureAuth(loginUser, picture);
    // æ„é€ è¯·æ±‚å‚æ•°CreateOutPaintingTaskRequest taskRequest = new CreateOutPaintingTaskRequest();
    CreateOutPaintingTaskRequest.Input input = new CreateOutPaintingTaskRequest.Input();
    input.setImageUrl(picture.getUrl());
    taskRequest.setInput(input);
    BeanUtil.copyProperties(createPictureOutPaintingTaskRequest, taskRequest);
    // åˆ›å»ºä»»åŠ¡return aliYunAiApi.createOutPaintingTask(taskRequest);
}
```

## æ‰©å›¾æ¥å£

åœ¨ PicØœtureController æ·»åŠ  AI æ‰©å›¾æ¥å£ï¼ŒåŒ…æ‹¬åˆ›å»ºä»»åŠ¡å’ŒæŸ¥è¯¢ä»»åŠ¡çŠ¶æ€æ¥å£ï¼š


```Java
/**
 * åˆ›å»º AI æ‰©å›¾ä»»åŠ¡
 */@PostMapping("/out_painting/create_task")public BaseResponse<CreateOutPaintingTaskResponse> createPictureOutPaintingTask(
        @RequestBody CreatePictureOutPaintingTaskRequest createPictureOutPaintingTaskRequest,
        HttpServletRequest request) {
    if (createPictureOutPaintingTaskRequest == null || createPictureOutPaintingTaskRequest.getPictureId() == null) {
        throw new BusinessException(ErrorCode.PARAMS_ERROR);
    }
    User loginUser = userService.getLoginUser(request);
    CreateOutPaintingTaskResponse response = pictureService.createPictureOutPaintingTask(createPictureOutPaintingTaskRequest, loginUser);
    return ResultUtils.success(response);
}

/**
 * æŸ¥è¯¢ AI æ‰©å›¾ä»»åŠ¡
 */@GetMapping("/out_painting/get_task")public BaseResponse<GetOutPaintingTaskResponse> getPictureOutPaintingTask(String taskId) {
    ThrowUtils.throwIf(StrUtil.isBlank(taskId), ErrorCode.PARAMS_ERROR);
    GetOutPaintingTaskResponse task = aliYunAiApi.getOutPaintingTask(taskId);
    return ResultUtils.success(task);
}
```

# å‰ç«¯å¼€å‘

å¯ä»¥å‚è€ƒåŸºØœç¡€ç¼–è¾‘å›¾ç‰‡çš„äº¤äº’æµç¨‹ï¼Œåœ¨ç¼–è¾‘å›¾ç‰‡æŒ‰é’®æ—è¾¹æ·»åŠ  AI æ‰©å›¾æŒ‰é’®ï¼Œç‚¹å‡»ä¹‹åæ˜¾ç¤ºå¼¹çª—è¿›è¡Œ AI æ‰©å›¾æ“ä½œã€‚

è¿™æ ·å¯ä»¥å°†Øœ AI æ“ä½œçš„é€»è¾‘å°è£…åˆ°å•ç‹¬çš„ç»„ä»¶ä¸­ï¼Œè®©åˆ›å»ºå›¾ç‰‡é¡µé¢çš„ä»£ç æ›´ç²¾ç®€ã€‚

## AI æ‰©å›¾å¼¹çª—

1. å…ˆå¤åˆ¶Øœä¹‹å‰å¼€å‘å¥½çš„è£å‰ªå›¾ç‰‡å¼¹çª—ï¼Œä¿ç•™æ§åˆ¶å¼¹çª—æ˜¾ç¤ºéšè—çš„é€»è¾‘ï¼Œä¿®æ”¹å¼¹çª—çš„æ ‡é¢˜ï¼š


```PlainText
<template>
  <a-modal
    class="image-out-painting"
    v-model:visible="visible"
    title="AI æ‰©å›¾"
    :footer="false"
    @cancel="closeModal"
  >

  </a-modal>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { uploadPictureUsingPost } from '@/api/pictureController'
import { message } from 'ant-design-vue'

interface Props {
  picture?: API.PictureVO
  spaceId?: number
  onSuccess?: (newPicture: API.PictureVO) => void
}

const props = defineProps<Props>()

// æ˜¯å¦å¯è§
const visible = ref(false)

// æ‰“å¼€å¼¹çª—
const openModal = () => {
  visible.value = true
}

// å…³é—­å¼¹çª—
const closeModal = () => {
  visible.value = false
}

// æš´éœ²å‡½æ•°ç»™çˆ¶ç»„ä»¶
defineExpose({
  openModal,
})
</script>

<style scoped>
.image-out-painting {
  text-align: center;
}
</style>
```

ç”±äº AIØœ æ‰©å›¾ä¸€å®šæ˜¯å¯¹å·²æœ‰å›¾ç‰‡è¿›è¡Œç¼–è¾‘ï¼Œæ‰€ä»¥å¼¹çª—çš„å±æ€§å¯ä»¥ä¸éœ€è¦ spaceIdã€‚

1. å¼€å‘å¼¹Øœçª—çš„å†…å®¹ï¼Œé‡‡ç”¨ä¸€è¡Œä¸¤åˆ—æ …æ ¼å¸ƒå±€ï¼Œå·¦è¾¹æ˜¾ç¤ºåŸå§‹å›¾ç‰‡ã€å³è¾¹æ˜¾ç¤ºæ‰©å›¾ç»“æœï¼Œä¸‹æ–¹å±•ç¤ºæ‰©å›¾æ“ä½œæŒ‰é’®ã€‚


```PlainText
<a-row gutter="16">
  <a-col span="12">
    <h4>åŸå§‹å›¾ç‰‡</h4>
    <img :src="picture?.url" :alt="picture?.name" style="max-width: 100%" />
  </a-col>
  <a-col span="12">
    <h4>æ‰©å›¾ç»“æœ</h4>
    <img
      v-if="resultImageUrl"
      :src="resultImageUrl"
      :alt="picture?.name"
      style="max-width: 100%"
    />
  </a-col>
</a-row>
<div style="margin-bottom: 16px" />
<a-flex gap="16" justify="center">
  <a-button type="primary" ghost @click="createTask">ç”Ÿæˆå›¾ç‰‡</a-button>
  <a-button type="primary" @click="handleUpload">åº”ç”¨ç»“æœ</a-button>
</a-flex>
```

å®šä¹‰å˜é‡ï¼Œç”¨äºå­˜å‚¨å›¾ç‰‡ç»“æœï¼š


```TypeScript
const resultImageUrl = ref<string>()
```

1. ç¼–å†™åˆ›å»ºä»»åŠ¡å‡½æ•°ï¼š


```TypeScript
// ä»»åŠ¡ idlet taskId = ref<string>()

/**
 * åˆ›å»ºä»»åŠ¡
 */const createTask = async () => {
  if (!props.picture?.id) {
    return
  }
  const res = await createPictureOutPaintingTaskUsingPost({
    pictureId: props.picture.id,
    // å¯ä»¥æ ¹æ®éœ€è¦è®¾ç½®æ‰©å›¾å‚æ•°parameters: {
      xScale: 2,
      yScale: 2,
    },
  })
  if (res.data.code === 0 && res.data.data) {
    message.success('åˆ›å»ºä»»åŠ¡æˆåŠŸï¼Œè¯·è€å¿ƒç­‰å¾…ï¼Œä¸è¦é€€å‡ºç•Œé¢')
    console.log(res.data.data.output.taskId)
    taskId.value = res.data.data.output.taskId// å¼€å¯è½®è¯¢startPolling()
  } else {
    message.error('åˆ›å»ºä»»åŠ¡å¤±è´¥ï¼Œ' + res.data.message)
  }
}
```

ä»»åŠ¡åˆ›å»ºæˆØœåŠŸåï¼Œè¦å¼€å¯è½®è¯¢ã€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€‚â€Œâ€‚â€‚â€‚â€‚â€‚â€‚â€‰â€‚â€‚ï»¿â€‚â€‰â€‚â€‰â€‚â€‰â€‰â€‰â€‚â€â€‰â€‰â€‰â€‚â€‚

1. ç¼–å†™è½®Øœè¯¢é€»è¾‘ã€‚æ³¨æ„æ— è®ºä»»åŠ¡æ‰§è¡ŒæˆåŠŸæˆ–å¤±è´¥ã€è¿˜æ˜¯é€€å‡ºå½“å‰é¡µé¢æ—¶ï¼Œéƒ½éœ€è¦æ‰§è¡Œæ¸…ç†é€»è¾‘ï¼ŒåŒ…æ‹¬ï¼š

* æ¸…ç†å®šæ—¶å™¨
* å°†å®šæ—¶å™¨å˜é‡è®¾ç½®ä¸º null
* å°†ä»»åŠ¡ id è®¾ç½®ä¸º nullï¼Œè¿™æ ·å…è®¸å‰ç«¯å¤šæ¬¡æ‰§è¡Œä»»åŠ¡

ä»£ç å¦‚ä¸‹ï¼š


```TypeScript
// è½®è¯¢å®šæ—¶å™¨let pollingTimer: NodeJS.Timeout = null// æ¸…ç†è½®è¯¢å®šæ—¶å™¨const clearPolling = () => {
  if (pollingTimer) {
    clearInterval(pollingTimer)
    pollingTimer = null
    taskId.value = null
  }
}

// å¼€å§‹è½®è¯¢const startPolling = () => {
  if (!taskId.value) return

  pollingTimer = setInterval(async () => {
    try {
      const res = await getPictureOutPaintingTaskUsingGet({
        taskId: taskId.value,
      })
      if (res.data.code === 0 && res.data.data) {
        const taskResult = res.data.data.outputif (taskResult.taskStatus === 'SUCCEEDED') {
          message.success('æ‰©å›¾ä»»åŠ¡æˆåŠŸ')
          resultImageUrl.value = taskResult.outputImageUrlclearPolling()
        } else if (taskResult.taskStatus === 'FAILED') {
          message.error('æ‰©å›¾ä»»åŠ¡å¤±è´¥')
          clearPolling()
        }
      }
    } catch (error) {
      console.error('è½®è¯¢ä»»åŠ¡çŠ¶æ€å¤±è´¥', error)
      message.error('æ£€æµ‹ä»»åŠ¡çŠ¶æ€å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•')
      clearPolling()
    }
  }, 3000) // æ¯éš” 3 ç§’è½®è¯¢ä¸€æ¬¡
}

// æ¸…ç†å®šæ—¶å™¨ï¼Œé¿å…å†…å­˜æ³„æ¼onUnmounted(() => {
  clearPolling()
})
```

5ï¼‰å½“ä»»åŠ¡æ‰§è¡ŒæˆåŠŸØœåï¼Œå¯ä»¥å¾—åˆ°å›¾ç‰‡ç»“æœï¼Œæ­¤æ—¶å°±å¯ä»¥ç‚¹å‡» â€œåº”ç”¨ç»“æœâ€ æŒ‰é’®ï¼Œè°ƒç”¨å›¾ç‰‡ URL ä¸Šä¼ æ¥å£ã€‚è¿™æ®µä»£ç å¯ä»¥ç›´æ¥å¤åˆ¶å·²å¼€å‘çš„ URL å›¾ç‰‡ä¸Šä¼ ç»„ä»¶ï¼Œè¡¥å…… loading æ•ˆæœï¼š


```TypeScript
const uploadLoading = ref<boolean>(false)

const handleUpload = async () => {
  uploadLoading.value = truetry {
    const params: API.PictureUploadRequest = {
      fileUrl: resultImageUrl.value,
      spaceId: props.spaceId,
    }
    if (props.picture) {
      params.id = props.picture.id
    }
    const res = await uploadPictureByUrlUsingPost(params)
    if (res.data.code === 0 && res.data.data) {
      message.success('å›¾ç‰‡ä¸Šä¼ æˆåŠŸ')
      // å°†ä¸Šä¼ æˆåŠŸçš„å›¾ç‰‡ä¿¡æ¯ä¼ é€’ç»™çˆ¶ç»„ä»¶
      props.onSuccess?.(res.data.data)
      // å…³é—­å¼¹çª—closeModal()
    } else {
      message.error('å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œ' + res.data.message)
    }
  } catch (error) {
    message.error('å›¾ç‰‡ä¸Šä¼ å¤±è´¥')
  } finally {
    uploadLoading.value = false
  }
}
```

1ï¼‰é€‚å½“å¯¹é¡µé¢åšä¸€äº›ä¼˜åŒ–ã€‚

ç»™ç”Ÿæˆå›¾ç‰‡æŒ‰é’®Øœæ·»åŠ ä»»åŠ¡æ‰§è¡Œçš„ loading æ•ˆæœï¼Œæœ‰ä»»åŠ¡ id æ—¶ï¼Œç¦æ­¢æŒ‰é’®ç‚¹å‡»ï¼Œå¯ä»¥é˜²æ­¢é‡å¤æäº¤ä»»åŠ¡ã€‚æ‰©å›¾ç»“æŸåï¼Œä¼šæ¸…ç† taskIdï¼Œå°±å¯ä»¥å†æ¬¡æ‰§è¡Œã€‚


```PlainText
<a-button type="primary" :loading="!!taskId" ghost 
  @click="createTask">
  ç”Ÿæˆå›¾ç‰‡
</a-button>
```

2ï¼‰æ·»åŠ åº”ç”¨ç»“æœï¼ˆä¸Šä¼ å›¾ç‰‡æ—¶ï¼‰çš„ loading æ•ˆæœï¼šR7zfQ2yjmCwaGmgYTa9cW+7DK0YPbs0kpW2reaJf93o=


```PlainText
<a-button type="primary" :loading="uploadLoading" 
  @click="handleUpload">
  åº”ç”¨ç»“æœ
</a-button>
```

3ï¼‰æœ‰å›¾ç‰‡ç»“æœæ—¶æ‰æ˜¾ç¤º â€œåº”ç”¨ç»“æœâ€ æŒ‰é’®ï¼š


```PlainText
<a-button type="primary" v-if="resultImageUrl" 
  :loading="uploadLoading" 
  @click="handleUpload">
  åº”ç”¨ç»“æœ
</a-button>
```

## åˆ›å»ºå›¾ç‰‡é¡µé¢å¼•å…¥å¼¹çª—

åœ¨åˆ›å»ºå›¾ç‰‡Øœé¡µé¢ä½¿ç”¨ç»„ä»¶ï¼Œå¯ä»¥åœ¨ç¼–è¾‘å›¾ç‰‡æŒ‰é’®å³ä¾§å¢åŠ  â€œAI æ‰©å›¾â€ï¼Œç‚¹å‡»æŒ‰é’®åæ‰“å¼€å¼¹çª—ï¼š


```PlainText
<a-space size="middle">
  <a-button :icon="h(EditOutlined)" @click="doEditPicture">ç¼–è¾‘å›¾ç‰‡</a-button>
  <a-button type="primary" ghost :icon="h(FullscreenOutlined)" @click="doImagePainting">
    AI æ‰©å›¾
  </a-button>
</a-space>
<ImageOutPainting
  ref="imageOutPaintingRef"
  :picture="picture"
  :spaceId="spaceId"
  :onSuccess="onImageOutPaintingSuccess"
/>
```

ç¼–è¾‘ç‚¹å‡»æŒ‰é’®åè§¦å‘çš„å‡½æ•°ï¼Œæ‰“å¼€å¼¹çª—ï¼š


```TypeScript
// AI æ‰©å›¾å¼¹çª—å¼•ç”¨const imageOutPaintingRef = ref()

// AI æ‰©å›¾const doImagePainting = () => {
  if (imageOutPaintingRef.value) {
    imageOutPaintingRef.value.openModal()
  }
}

// ç¼–è¾‘æˆåŠŸäº‹ä»¶const onImageOutPaintingSuccess = (newPicture: API.PictureVO) => {
  picture.value = newPicture
}
```

è¿è¡Œæ•ˆæœå¦‚å›¾ï¼š

![](assets/VSoEbziWEoEKg1xm5sXcuYBRn8f.png)



