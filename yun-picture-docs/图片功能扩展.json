{"nodes":[{"block_id":"CUIedlnR5olgtSx9WhtcTV1knke","block_type":1,"children":["Dydid3nWUoUF3wxFgHbchEjvn1b","F5jBdnF2zoTG2SxmEHdc3gSandh","IibtdNy3no0c0mxc5NBcMWlIn3e","WpJeddvdgo12yaxgR1Ecq8O5nve","D3OYdXccOoZ16nxRImIc2nWqnZc","R1Mpd65D0omGeQxHp2scY57Znyc","VVBgdW666osC4ExccLwcaC9tnWS","SGN1dOqt4oZXszxdNyeciGGEnkn","HEY8dHUujo2os4xJdbQck3irnKv","Dr3DdxG4boYCe1xo0SGcfXJ7nXg","NUyvdQybWoDghkx8ALNcd8fGnqc","EJx5dtlimoJaSYxuFLGcR427nih","Q0ZpdRTTxo1lkHxkLMtcx5Avnoe","JNyqdRee2oeymqxrznjcZllennR","Sh1NdIGheow3CIxnqjncIV7lnZg","Uy2xdLWunom8boxpwWpcUqkqnFc","ZDEudh38KobPEox8amqc2Gerncg","KLbddoEggoUvqaxkHVHc8K2Pnmf","Q39fdVJNFoUieLxOSY1cCrVMnQB","YV5DdYrVuoO4jQxDjVEcIbK8nzh","NTxjdyj0OoKQHMxwf76chKcdnmg","XslkdvV7CoOFQHxwbKjclgaJnte","Vvu6dvOxIooGtXx5yKMcn7fknue","RAxhdNlSZo2atEx83Znc7Ifwnyd","SEGqdxi6DoRzaexKqweclvVwnMf","VpPydyF29oLwlnxOfm0cxAHdnJb","EQ0jdy4ygoM5TAxBH7qcwa35nng","BOVBd4FHgolzI7xEccTcm05FnKe","HAV2dDJ2jocYEMxjUaPc9XylnBh","G57Rds4Prob9RNxxB7UcTXz0nOg","LIb7doCBnodzmMxIfdJcd99RnWe","OzOsd4JsJow3xEx4o5zcD3RSnwe","JVu3dBtfLoBMbAxFtcpcjywmnxY","AWWddqjUtomPKBxoYyLcBIuxnlg","ONOddpgsAoxjKsxBi5Ucjbrcngc","ERZYdXpbuoa8SaxUl5gcxkVUnxf","N8UldpEePoVPrix2pEWcrlK0nuy","BWJJdqGbjouS8mxjcItc02XFn0g","BMCBdrg3VoJhlNxaaCLcdctknrh","P97adCsUHobeu8xtffLcf4z9n2b","EqNpdFXIJoyJjwxZcN6csLI0ngf","IGoKdeGUPoaNtxxhyCTcm71enHe","Avk0dhw1hokNEmxarF0cdTRZnib","TDLSd6csZoaA7UxYxudc8sDTn9d","ERPPd6Q64oJzaoxgWFfcMo8Nnch","SkEpdJwI0oICsnxwB9tcT2BfnLe","RJP9dVpKKokG3PxxDRDcjwFinZg","Mm1cdm7kbotynzxmDFKcOsBantb","HmigdJSJUoNv1Rxim4TcfrhonVf","Nt4pdxN2SoI1ZTxdcWVc0S4znUd","Xeg2d3SBAonbMxxF6M9cqSs5nYf","FW7fdrON4og4zCxQBaLcpemsnTg","CKbVdp1QAo8xUox5DPHcLK0jnKc","EusedvUtpol4Dxx0eC2cuEiwn2b","NGCLdHimNopnI6x08ihcBwmynQm","AVUvd7P9do3V8BxKcVbcWJcpn3g","Zbsnd2vfKoA4X3xeom7cWHLinbg","ZUawd5wS6oM9J1xRATJcVPV1nRf","PpFQdFgAsowYckxhWFAcrpQInDc","FVoIdqlsooiPnuxIaGic0fmxncf","NrfddE5OCoS2LyxWlZqcm9aWnDe","RTnBduQQPoS7RpxkmkPcE4kunNh","K1WOdmVkNoAWT7xMtdMckRsQnjc","FffJdIXspo0FKdxawh3ckzCRn9f","F3X5dW1g4oyj2gxaCw0ck1VTnUh","CW63dZWVRoqTa2xv97ecI8Rhnoh","LbkRdrEzVoNZsmxeVEbctLsCnob","WSaxduIq3oBf2fxTlOsci1VnnCc","KNpyd7jMPotdkYxjbMkcEOUEnPg","HFG2dFzTboyYCVxAQ9Sc3EGSnKN","SuwpdFKN9oTf18xmqk4cnvH7npc","Cm4bdFKzXoO3w5xfc0Tc6DtenKw","ULIudzxAUorgc4xUocDchkWwnJf","GevGd1VLfomEmdx94mscC07vnjc","N46BdEqWvo0YVtxj8xbcWn1wnie","RgR5dgEPnoQkfNxudYecLUFFn1d","WpHXdgc96oFw7Vxt13OcPneRnib","TKFvd32xdoAST9xwqOac9TeynHe","RWVMdsprmopt2lxoDD8cGbolnrf","Xb6qd81bYonY1nx7Qtnceza6nDf","JUuedjERtoT3kKxFhEVcxEzmntg","COwRd7Y75oRjlAx5JkCczWcSnrc","Lk2Pd3AMCoKb7AxrsOgcHzfxnAc","PrUAdl9Nwofwi3xm9SZcrKKin3c","VIledqTOfohDZPxAeILct8Y8nTc","QYaWdDZA0oBr0kxGAebc3gq6nNc","D9WVdXuZJo6twjxvEcEctHrInbc","LhnXd3NYDomPWcxATUKc27Ilnvg","SYGXdT90Po6hNxxqCiNc9tcOn5f","D9TndXjQqok56cxC3e9c4Dp2nvg","GbWxdgJehoVKrSx1r4fcCL7SnSh","GgoudDlEjoG12XxF0Cicnvr0nZd","MW71dfsfeor8UxxnjTgcujfqnqd","LDJ0dwU7uourOixMoHYcEScOnEh","FbmQdW33CoJ8DcxWMphcxilyn9g","WIQadAa0Xow8YhxKwKkcazgUnWc","AbWudKWHWoFxjyxAButcANfdnfc","Yof5dH54Lo8s0lx383GcGEdQnll","Nx48dZMdco1AvVxmwx1ct7nwnjh","Ukq0dYIPuoBjQrxWy72cu9pynHb","SuFIdGxxaoaweex9aqUccoRLnFf","KDkTdhsQhopXsRxCjdWcb84xnbd","ZNnedkUfvojLbaxmx1icbtL1n8c","QtbDdukVAo0fYFxnuFwcNdGQnge","DOcTdIIHXo0qrBxC14gcKZITnFg","IjeYd1lJEoMEvyx6Ow3cUQVFneg","FinddaOGnoUqdlxheEecb9TLnib","MYaJdzFGuoTp0QxiLoNcufjZnDd","JedGdOmyro3VIoxaUbHc6v6dnIf","KMgzd4D5OoNfWVxpf1ychHITnPf","JrSfdqelLoY4ztxl7tZcdOMtnLf","CFzMdAe6BoPQbwxg0zLcvsJhnje","GfrJdrHknoGAwnxQbAaczX6GnKe","NIkBdLqTPoy5jxxDogiclNQ4nuc","YM7MduojpoQ2BExVPjicB9DonPd","YqEeddmrco398Wx95H2cRHCmn8d","J8BSdwiCho6z8oxZnvYci8Uen2f","WeD8dI0UZoAjz0xIp90ctxU9n8f","KC8wd2fKZo2OWXxyywJclkG9nZe","WJ3ZdJeQTo2egvxtGyucHmIqnFe","Sqo8dbD9yowKshxqqgCcRJekn4e","PP6SdtgdBoSuGoxaew6cKK1tnaf","Y5ccdHCbYouxG4xkbQIcqMYrnxc","Ok4GdIdHConn2XxXe0Sce4minHg","K5RVdHN0IooxLIxSHzvcgBfHncc","NzRxd9UDPoxgdnxQnrsc2lzyn3f","Qtdddj09toZKZWxGTNOc4ICdnVg","WFhNdKOGfob7WyxBylfcPGVMnab","DbH0dARhxoMZpxxk03ccEfdsnse","RDAZdqrO4oHZhUxPGoEc3DUMn1l","Jv9mdyO4doyL1JxrmchcD5kvnSb","KdImdDxO9o05Jox0XP5cEUapn6d","Vm0vdRWswoL9Vnx0agkc68knnbd","ZcLGdqMELogLmax6UREcXRdTn5f","XLNhd8X2iotDd5xKwYIcNcMtnjc","VjWqdwsZqoC6JyxU6HQcVrpEn0c","Xa3LdS3AHo241Px1Brmc8YeUnzb","FE6ud9XjbogxBAxgAjccq9Z5nff","G4ycddNAOoHjePxjuIwcyIxsnqf","S6sldvYvtoObl8x7xfvc0wtVnsf","GnpSdrGoIorDPLx8mQ5cfo0gn9f","Kb71dIjG1oQ2Uxx778PcODCmnt2","MOikdizxioc4KMxzbMtcawJCnOe","NoDFdAmiLo8AbHxo1KIcgmr6n4b","CcRVd2h8lorDxHxlUpJcetLfnMf","XXs4dafJfoeIa4xH6ydckOHsnLf","El61d70wpobgjmxoJNgcJRg8nlb","WLcndjNr5o40y8xSrPccibQ2n0c","GjBJdkL4HoM8YxxiODBcPpZ8nyf","SWnndBRZvoQ9t2x2kOfcI51DnFd","Irlfdm1eLoYG2wxz5o4cxwzPnsb","PT3DdChL0o5pnAxMp3hcuDshnbg","DMfnd5X3so0Nz0x2t7xc6LRBnxh","A0hhdG6buoDhDHxCvKacnFuAnBS","AtF0dw5FyoytkTxI2lRc8WsJnxB","PqhEdPEaioN8vDxivREcGVoYngn","G5h5d1mWgo4EPdxC2adcvVF4nGd","SfQgdd0H8oBWkmxHSPsc9oomnTg","Xghkdlgnboz9yaxUOIOcxqiJnsf","W7KXd3jrooxfRMxgUYNcKnZYn2d","ExHEdZvwyoF7zpxVq4gcqyUtnyh","D2G8dd3ZRoiluJx5LERcxkuWnlf","Rjf7dHflaoZmLfxbjuFchtfOnOe","QslcdTcDGod6fRxQxuzcBD48nZb","U5lWdEhqGoj5E3xENabciU9fn3f","WDphdJkjAoiH7Exjnt7cTTo3nLf","MOxKdufEMoguTPxrVvqcQUTQnXS","Ryy2dEirso1UyRx07bGcEonpnAh","KeBOd5cStotUxFxwuSxcEBe8nih","DmA4dihQfo7qdDxSX6hcFbFSnfe","TxhndbjJLo7hWFxeHWYcsFlhnBq","A8wAdwE96oK5m5xFooVcTdsZn4b","SnOAdBoyloY8JXxSeeccCC9rn0d","EUAHdDlLRohueJx67NkcKgvwnWf","X2kHd0rrooKM37xIS5QctcXln8f","V1MrdKagGoEJz3xM0Zxcw6w9nsb","EDN2dEVbYoxZLXxIXztcJI8enyd","Y9NzdeGkeoH26UxPtiXcAq03n5g","GfvLdq3kkocDMMx1iS6cjjV5nGX","CTUKd21spoDFw1xUvNjcGf1snME","TQPmdppJ2oL2HzxmNFWcG5jIn2d","QRwXdNZ46oR1Vnxk95rcoLELnle","QarcdXgx4oXbdkx4aghcS0Dtnze","QmAOdBncjoDrw8xyvYVcm6kQnnd","O4VrduugboWBxQxwEfyc2FlBn4b","Ja5Mddcynout3JxeCBHc80Qlnwh","RZ7NdTLXHodv2dxlTHecRkebnQz","RabWdiy4GoYHwIxNFy1cmxKxnwf","ApVPds0E4oMOIIxiszqcVzYpnIe","Lb4sdcnqMoAyZzxxkAQcGJKbnDb","O7zsdG6NMoWviGx6CCZcgi97n9f","CSi8db906oXV7cxFWhFcovDjnKh","QAlAdwNgpoVaZLxFkwgcxnhXnqg","RSRqdoUpVoHYDNxfnCbcvUCenjd","ULXLdyaXjoAocUxcLToc9kYQnEc","UgapduEonoXV3oxjtZpcb6npncb","Ff5tdTGVQooLaSxbqUec7JAJnkg","Vjtcdqdamoburmx9OanclxElnVc","Xn96dH82zoot38xWhnec5nWSnsd","GgaEd3YiOolouUxilQ3cAHF4nHh","BbvAdZ6ExonwSBxxczdcwgb6nec","SFeYdrzGqoLq75xSSGlcg8FPnEd","EDuMdzTEGoplSSxTa8NcyStVnwb","V0qAdsExmoYzTkxiE1hcwgY5nCh","ZsdxdcQsGokAKixejKhcyeMdnfy","KcQJdS4Ivo3bv4x57trcfDN3nNf","Uw9VdPUowoFH8Jxqby3cia5Pn7f","OjCMdiOrIoxJgPxSJNVcQhe4nAh","Y5O1d8770owDecxpexhc16BXnAc","CAF8drVuIohwVaxBZpvcTqPmn8y","VplydajZRovWQuxzAvKcCo8jnKg","Y233dd4tNoZIGbxkcG5c5PlOnWc","HSNRdPHo9ovtI8xMK4fcs6Xwnof","NPfpdwvF8oSh5vxCecIcL4N7nXg","PWE8dw4MRoMZhuxAKf4cVBvknBf","Qmxmd31VcoimmNxtKdbc4Y0Cnxc","KMkldEXX1ozBpJx3mIDcqfCnnlc","WyvxdJU9qocZiqx2vJZc0qzSnLk","FWFidMAXNoyzaFxNvDqcGxgTnZf","Pk8vdZBTQoe3ZHxtPBlcywUmnpg","R40IdaTLxooXzHxFAg1c2jvpnMd","EAPPdgYQDocgrGx4sJfctxa0nub","L0GMd8jjBoeMVAxnPzrcoRhJnID","Fg8hdcrS9oCQ9ExwH5HcCpGVnZ5","LXZUd3FO1oxdgIxF29RcW6AsnHg","PWqkd3wb1oDQ2Hxjo97c9g8vn8g","P5r1dkwkBosa0cxcshUcg0Qzncg","KANUdxbeUoRIhnxdwmjcsEgAnUf","Kae4d3gyHoQQQvxwtovcHTMgn0b","JAGVdd4qcoaoVPxuu5AclMTPnld","Z5fddmyi8oXcL3xkgZJcbWMrnTG","VIdOdJYCXoFMjsx4gXtcCndxnOd","YgxldcsOAoXLktx3ehxcPgMwnxg","HDLjdvRu7o0nQOxVWOpcyacunHc","EopzdZmgDokmyHxkpXJco1EcnBg","SDrvdcZSKohAxSxjwfGcFnjInnh","CNq9dPDNfomQBnxL6NbcmlwCnIb","WOtjdvkugousuVx1XJycLV6Xn6c","SEy3dEmM8oAa9pxBLczc5tbonkg","JgrXdkjNwolekHx3z60cs06Dnog","YcybdxbSGo88gexUVC0cQ7rdnwe","G0cldd44QohiOxxxg0hciLhFnIg","MtVCdQjRFoIuqlxe7UucPPhznLg","HYD6dfIVPoWGYoxvk6TcXlXNn0b","Bu0edslqBoX7FmxeX4FcJ2uBngd","Hurbd89icoKthQxH8dIcsgownKc","ZDrxdiEsgofKQxxFcDlcpsrHnmf","MgtIdrE0Sojbz9xiQUycHMT6ntf","BvI4dynAKoDlIexdRFUcPTksnuI","A6uydfXFooGlTLx4pWUcWNNOnbh","VYo7dKHjvocE9FxBmnEcok9LnRc","DPpjdii6to6vF5xu6qbcZZLinoh","TWENdC00LoJp6rxMyYHcO2q2nUf","UprMdkju9oFfwAxPwM0c690Qnqg","NALPdU5M1ounWXxZ9SeckfsTnFg","EVmmd7t2noV5XuxLsxOcdQf7nrc","CukqdDYY6oP9tFxdUfJcxcZVngc","FlvfdCuMKois7HxQruncCQwonPf","NvPBdChtwodSEfxzd8KcDndGnRe","BcLMdi1Obod7BLxS1fzcJZxQnyc","RhvZdhpP0ogc0gxTPrScdVjEnNL","PXHjda55SofF2oxSkkycKDWgndg","AFlMd5aCNoSd0kx93gHcVofnnhd","YMTidlZ9woUnoYx8R8TcZdtEnpd","ZwpEdiSS6oMQN7xAxGrckBlRn7g","AZO3dCItVozpRkxWqG7cDNQinCP","XQuJd0YTzoRDLyxbdXEcRx8Lnee","ZoYVdLIs5o0VRCxLGnDc6t6InMb","Spztd9s25oTcXGxOo9sc3A7Xnhh","D3sKd1BMwo03MPxG8VHcosU1nNh","BmS5dmxTno7RRuxvamycOZY7n1d","OcrBd9nydogCloxylPkcyIWAnrf","Kynfdr3bko1kUZxMYK1csasBnJg","FASRdHC23oP2KHxP3yQcXIXMnKh","Vx9hd0oCVoMWw7xr3sNcAMVrn8b","QDz5dfcZFoXvTpxBnSEcNvi4nNg","DteTdFOyLoRyTnxq9VscG6hEnBf","Y6IadddlioXqM8xsA3icOpNgnEd","MM0AdpGOcoC2uVx9fMrcxvJOnDd","ASEYdpOnsoCV08xNehUc2LxCnve","HIBrdhW4SoEVMXx0DoNctv9xnHh","C00wd31emoBvwXxdbWwcpyzRnOf","DSf0dvuskoqBTCxSVMScCe0xnUg","Eahbd86wwoVXoGxO7ZXc6wadneb","LuNRdH5KLoe1qfxNla0cfWQjnjd","TTugdm6okokkgSxgWlCcxBPNnle","FMdCd40TKoMUkyxSPoQcVuXNntf","H7qVdlRedom6lwxRbI5cUYi7n9c","E2UXd1QM5ocyBhxOSB4c8KbAn0g","MiBTdqZ0xoV6s1x4qSqc1m2jnMb","DBD6dzV8QoLxhJxbFgCcMupUnuh","HBTPdMKOcoV6O6xkGkxcna80nQe","JbNNdjH6WoEYwvxdk3kcfBW0n9f","Txwcdziu4o1xsnxdntLcl4uenYp","QdsqdBBYpounWqxVJjPcCGYAnzf","F7P9dUlV0ofKGQxTayjceYGYnpc","UrB3dLSSPoQb2Cx9CpTcMk79nUb","V16edvCVKopOR9xp2T3cleamn2g","YOEOdibZ4oNecVxSHayc4Kaon2f","QUJMdAiCvoNdbYxyGsAc1jeqnUh","FGqadtZGZoVHrHx4rBhcXOZSnFg","UfXBd3rP2ogAcixWMOcc7lCtnxg","L5iXdmOu3oeveIxcmnKctyTentg","UmEmdrhN9oMflixmlqncebQxnBh","EFKnd3clCoVbHWxTE9zcTR5jntd","BmlVdZFA3o7uoFxta8VcBQzfnSb","BJCGdHjIaoNVjuxy7TvcRxaynic","FhTrdkBrSoLX2Bxy14bceLrtncc","MfAGdQ8kiomyzpx4pXVcXIcLnZc","QVBSdnheToFJXdxGD8dcJuTTnhh","RY0jddy0qoAN0uxo3q3cTDMAnrb","Z8Kud7zP6ofTV5xWBFDcNn4nnnf","BkUbdRZExouBVKx4QFKc5zERnie","XfHGd4Z2MoIlfrxWDy1cYG9Lnwg","CHQfd9UuyoDs5oxw4WucRm0YnBe","S0hRdbwGXorgudxFtcmckogjnVc","UWpDdmDhhoRCPnxW1ErcTMBlnwh","RjM2d93vFog3CyxYRT2cgMR9neg","OI9gdIhCTo5ul4xwVfxchUSsnjM","IidHdiPKLoBhWIxHhC2cXvRinEf","RyWDdfiXgoZh01x5BGEckK6FnAb","MVhRduPEeoJbcPxEPEwcuk29nVd","IEopd4uhhoFOfNxqOWacfVzpnag","N3wUdhV6Houv8cxqn2wceeG0ned","OMPFdBe60oCrcTxxaEuchmvKnSh","R2SGdEKQkoXzppxKs92cPX9rnrg","J9n6dNW7UoLN5Ixl9f7cKn74nsh"],"page":{"elements":[{"text_run":{"content":"图片功能扩展","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1}},"parent_id":""},{"block_id":"Dydid3nWUoUF3wxFgHbchEjvn1b","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"为了吸引用؜户使用我们平台的私有空间作为个人相册，需要提供更多功能。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"F5jBdnF2zoTG2SxmEHdc3gSandh","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"本节我们重点对图片功能进行扩展，包括：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"IibtdNy3no0c0mxc5NBcMWlIn3e","block_type":12,"bullet":{"elements":[{"text_run":{"content":"图片搜索","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"WpJeddvdgo12yaxgR1Ecq8O5nve","block_type":12,"bullet":{"elements":[{"text_run":{"content":"基础属性搜索","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"D3OYdXccOoZ16nxRImIc2nWqnZc","block_type":12,"bullet":{"elements":[{"text_run":{"content":"以图搜图","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"R1Mpd65D0omGeQxHp2scY57Znyc","block_type":12,"bullet":{"elements":[{"text_run":{"content":"颜色搜索","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"VVBgdW666osC4ExccLwcaC9tnWS","block_type":12,"bullet":{"elements":[{"text_run":{"content":"图片分享","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"SGN1dOqt4oZXszxdNyeciGGEnkn","block_type":12,"bullet":{"elements":[{"text_run":{"content":"链接分享","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"HEY8dHUujo2os4xJdbQck3irnKv","block_type":12,"bullet":{"elements":[{"text_run":{"content":"扫码分享","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Dr3DdxG4boYCe1xo0SGcfXJ7nXg","block_type":12,"bullet":{"elements":[{"text_run":{"content":"图片批量管理","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"NUyvdQybWoDghkx8ALNcd8fGnqc","block_type":12,"bullet":{"elements":[{"text_run":{"content":"批量修改信息","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"EJx5dtlimoJaSYxuFLGcR427nih","block_type":12,"bullet":{"elements":[{"text_run":{"content":"批量重命名","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Q0ZpdRTTxo1lkHxkLMtcx5Avnoe","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"有了这些功؜能，用户能够更高效地管理和分享平台上的图片资源，进一步提升使用体验。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JNyqdRee2oeymqxrznjcZllennR","block_type":3,"heading1":{"elements":[{"text_run":{"content":"图片搜索——基础属性搜索","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Sh1NdIGheow3CIxnqjncIV7lnZg","block_type":4,"heading2":{"elements":[{"text_run":{"content":"需求分析","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Uy2xdLWunom8boxpwWpcUqkqnFc","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"我们可以提供多种搜索维度，帮用户更快地找到自己空间的图片。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"ZDEudh38KobPEox8amqc2Gerncg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"将搜索维度按优先级进行排序，优先级高的会展示在靠前的位置：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KLbddoEggoUvqaxkHVHc8K2Pnmf","block_type":12,"bullet":{"elements":[{"text_run":{"content":"关键词：同时搜索名称和简介","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Q39fdVJNFoUieLxOSY1cCrVMnQB","block_type":12,"bullet":{"elements":[{"text_run":{"content":"标签","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"YV5DdYrVuoO4jQxDjVEcIbK8nzh","block_type":12,"bullet":{"elements":[{"text_run":{"content":"分类","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"NTxjdyj0OoKQHMxwf76chKcdnmg","block_type":12,"bullet":{"elements":[{"text_run":{"content":"编辑时间（开始时间与结束时间）","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"XslkdvV7CoOFQHxwbKjclgaJnte","block_type":12,"bullet":{"elements":[{"text_run":{"content":"图片名称","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Vvu6dvOxIooGtXx5yKMcn7fknue","block_type":12,"bullet":{"elements":[{"text_run":{"content":"图片简介","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"RAxhdNlSZo2atEx83Znc7Ifwnyd","block_type":12,"bullet":{"elements":[{"text_run":{"content":"图片宽度","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"SEGqdxi6DoRzaexKqweclvVwnMf","block_type":12,"bullet":{"elements":[{"text_run":{"content":"图片高度","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"VpPydyF29oLwlnxOfm0cxAHdnJb","block_type":12,"bullet":{"elements":[{"text_run":{"content":"图片格式","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"EQ0jdy4ygoM5TAxBH7qcwa35nng","block_type":4,"heading2":{"elements":[{"text_run":{"content":"方案设计","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"BOVBd4FHgolzI7xEccTcm05FnKe","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"后端可以直؜接复用原有的分页获取图片列表接口，并在此基础上增加相应的搜索条件，以支持更灵活的筛选。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HAV2dDJ2jocYEMxjUaPc9XylnBh","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"前端可以针؜对不同类型的搜索维度选用特定的表单项组件，来提高搜索的体验。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"G57Rds4Prob9RNxxB7UcTXz0nOg","block_type":12,"bullet":{"elements":[{"text_run":{"content":"关键词：文本输入框","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"LIb7doCBnodzmMxIfdJcd99RnWe","block_type":12,"bullet":{"elements":[{"text_run":{"content":"标签：下拉选择框","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"OzOsd4JsJow3xEx4o5zcD3RSnwe","block_type":12,"bullet":{"elements":[{"text_run":{"content":"分类：下拉选择框","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"JVu3dBtfLoBMbAxFtcpcjywmnxY","block_type":12,"bullet":{"elements":[{"text_run":{"content":"编辑时间：日期选择器","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"AWWddqjUtomPKBxoYyLcBIuxnlg","block_type":12,"bullet":{"elements":[{"text_run":{"content":"图片名称：文本输入框","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"ONOddpgsAoxjKsxBi5Ucjbrcngc","block_type":12,"bullet":{"elements":[{"text_run":{"content":"图片简介：文本输入框","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"ERZYdXpbuoa8SaxUl5gcxkVUnxf","block_type":12,"bullet":{"elements":[{"text_run":{"content":"图片宽度：数字输入框","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"N8UldpEePoVPrix2pEWcrlK0nuy","block_type":12,"bullet":{"elements":[{"text_run":{"content":"图片高度：数字输入框","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"BWJJdqGbjouS8mxjcItc02XFn0g","block_type":12,"bullet":{"elements":[{"text_run":{"content":"图片格式：文本输入框 / 下拉选择框","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"BMCBdrg3VoJhlNxaaCLcdctknrh","block_type":4,"heading2":{"elements":[{"text_run":{"content":"后端开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"P97adCsUHobeu8xtffLcf4z9n2b","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"其他的搜索条件基本都已经有了，还需要支持按照编辑时间搜索。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"EqNpdFXIJoyJjwxZcN6csLI0ngf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）为了支؜持按编辑时间进行搜索，需要在请求类 PictureQueryRequest 中添加开始和结束编辑时间字段：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"IGoKdeGUPoaNtxxhyCTcm71enHe","block_type":14,"code":{"elements":[{"text_run":{"content":"/**\n * 开始编辑时间\n */private Date startEditTime;\n\n/**\n * 结束编辑时间\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" */private Date endEditTime;","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Avk0dhw1hokNEmxarF0cdTRZnib","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）更新图片服务的 getQueryWrapper 方法","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"TDLSd6csZoaA7UxYxudc8sDTn9d","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"在处理查询时，补充按编辑时间筛选的逻辑：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"ERPPd6Q64oJzaoxgWFfcMo8Nnch","block_type":14,"code":{"elements":[{"text_run":{"content":"Date startEditTime = pictureQueryRequest.getStartEditTime();\nDate endEditTime = pictureQueryRequest.getEndEditTime();\nqueryWrapper.ge(ObjUtil.isNotEmpty(startEditTime), \"editTime\", startEditTime);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"queryWrapper.lt(ObjUtil.isNotEmpty(endEditTime), \"editTime\", endEditTime);","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"SkEpdJwI0oICsnxwB9tcT2BfnLe","block_type":4,"heading2":{"elements":[{"text_run":{"content":"前端开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"RJP9dVpKKokG3PxxDRDcjwFinZg","block_type":5,"heading3":{"elements":[{"text_run":{"content":"1、图片搜索表单组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Mm1cdm7kbotynzxmDFKcOsBantb","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"由于空间详情页的代码量较大，我们可以将所有图片搜索逻辑单独封装为图片搜索表单组件 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"PictureSearchForm.vue","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。为提高效率，该组件可以从图片管理页面的搜索表单复制而来。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HmigdJSJUoNv1Rxim4TcfrhonVf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"注意，该组件仅负责修改搜索条件，不负责数据获取与存储。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Nt4pdxN2SoI1ZTxdcWVc0S4znUd","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）定义组件属性：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Xeg2d3SBAonbMxxF6M9cqSs5nYf","block_type":14,"code":{"elements":[{"text_run":{"content":"interface Props {\n  onSearch?: (searchParams: PictureQueryRequest) => void\n}\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"const props = defineProps<Props>()","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"FW7fdrON4og4zCxQBaLcpemsnTg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）编写搜索条件和搜索函数：使用 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"reactive","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 变量存储搜索条件，并触发父组件的 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"onSearch","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 方法。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CKbVdp1QAo8xUox5DPHcLK0jnKc","block_type":14,"code":{"elements":[{"text_run":{"content":"// 搜索条件const searchParams = reactive<API.PictureQueryRequest>({})\n\n// 获取数据const doSearch = () => {\n  props.onSearch?.(searchParams)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"EusedvUtpol4Dxx0eC2cuEiwn2b","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"3）开发页面结构","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"NGCLdHimNopnI6x08ihcBwmynQm","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"其中：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"AVUvd7P9do3V8BxKcVbcWJcpn3g","block_type":12,"bullet":{"elements":[{"text_run":{"content":"日期表单项使用 Ant Design 的 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"日期选择器组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fantdv.com%2Fcomponents%2Fdate-picker-cn%23components-date-picker-demo-presetted-ranges"},"strikethrough":false,"underline":false}}},{"text_run":{"content":"，支持预设的日期范围选项（比如过去一周）","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Zbsnd2vfKoA4X3xeom7cWHLinbg","block_type":12,"bullet":{"elements":[{"text_run":{"content":"宽度 / 高度表单项使用 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"数字输入框组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fantdv.com%2Fcomponents%2Finput-number-cn"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"ZUawd5wS6oM9J1xRATJcVPV1nRf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"代码如下：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"PpFQdFgAsowYckxhWFAcrpQInDc","block_type":14,"code":{"elements":[{"text_run":{"content":"<div class=\"picture-search-form\">\n  <!-- 搜索表单 -->\n  <a-form layout=\"inline\" :model=\"searchParams\" @finish=\"doSearch\">\n    <a-form-item label=\"关键词\" name=\"searchText\">\n      <a-input\n        v-model:value=\"searchParams.searchText\"\n        placeholder=\"从名称和简介搜索\"\n        allow-clear\n      />\n    </a-form-item>\n    <a-form-item label=\"分类\" name=\"category\">\n      <a-auto-complete\n        v-model:value=\"searchParams.category\"\n        style=\"min-width: 180px\"\n        :options=\"categoryOptions\"\n        placeholder=\"请输入分类\"\n        allowClear\n      />\n    </a-form-item>\n    <a-form-item label=\"标签\" name=\"tags\">\n      <a-select\n        v-model:value=\"searchParams.tags\"\n        style=\"min-width: 180px\"\n        :options=\"tagOptions\"\n        mode=\"tags\"\n        placeholder=\"请输入标签\"\n        allowClear\n      />\n    </a-form-item>\n    <a-form-item label=\"日期\" name=\"\">\n      <a-range-picker\n        style=\"width: 400px\"\n        show-time\n        v-model:value=\"dateRange\"\n        :placeholder=\"['编辑开始日期', '编辑结束时间']\"\n        format=\"YYYY/MM/DD HH:mm:ss\"\n        :presets=\"rangePresets\"\n        @change=\"onRangeChange\"\n      />\n    </a-form-item>\n    <a-form-item label=\"名称\" name=\"name\">\n      <a-input v-model:value=\"searchParams.name\" placeholder=\"请输入名称\" allow-clear />\n    </a-form-item>\n    <a-form-item label=\"简介\" name=\"introduction\">\n      <a-input v-model:value=\"searchParams.introduction\" placeholder=\"请输入简介\" allow-clear />\n    </a-form-item>\n    <a-form-item label=\"宽度\" name=\"picWidth\">\n      <a-input-number v-model:value=\"searchParams.picWidth\" />\n    </a-form-item>\n    <a-form-item label=\"高度\" name=\"picHeight\">\n      <a-input-number v-model:value=\"searchParams.picHeight\" />\n    </a-form-item>\n    <a-form-item label=\"格式\" name=\"picFormat\">\n      <a-input v-model:value=\"searchParams.picFormat\" placeholder=\"请输入格式\" allow-clear />\n    </a-form-item>\n    <a-form-item>\n      <a-button type=\"primary\" html-type=\"submit\" style=\"width: 96px\">搜索</a-button>\n    </a-form-item>\n  </a-form>\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</div>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"FVoIdqlsooiPnuxIaGic0fmxncf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"日期表单项所需的变量：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"NrfddE5OCoS2LyxWlZqcm9aWnDe","block_type":14,"code":{"elements":[{"text_run":{"content":"const dateRange = ref<[]>([])\n\n/**\n * 日期范围更改时触发\n * @param dates\n * @param dateStrings\n */const onRangeChange = (dates: any[], dateStrings: string[]) => {\n  if (dates.length < 2) {\n    searchParams.startEditTime = undefined\n    searchParams.endEditTime = undefined\n  } else {\n    searchParams.startEditTime = dates[0].toDate()\n    searchParams.endEditTime = dates[1].toDate()\n  }\n}\n\nconst rangePresets = ref([\n  { label: '过去 7 天', value: [dayjs().add(-7, 'd'), dayjs()] },\n  { label: '过去 14 天', value: [dayjs().add(-14, 'd'), dayjs()] },\n  { label: '过去 30 天', value: [dayjs().add(-30, 'd'), dayjs()] },\n  { label: '过去 90 天', value: [dayjs().add(-90, 'd'), dayjs()] },\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"])","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"RTnBduQQPoS7RpxkmkPcE4kunNh","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"4）获取分؜类和标签表单项的默认选项列表，这段代码可以直接复用创建图片页面的：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"K1WOdmVkNoAWT7xMtdMckRsQnjc","block_type":14,"code":{"elements":[{"text_run":{"content":"const categoryOptions = ref<string[]>([])\nconst tagOptions = ref<string[]>([])\n\n// 获取标签和分类选项const getTagCategoryOptions = async () => {\n  const res = await listPictureTagCategoryUsingGet()\n  if (res.data.code === 0 && res.data.data) {\n    // 转换成下拉选项组件接受的格式\n    tagOptions.value = (res.data.data.tagList ?? []).map((data: string) => {\n      return {\n        value: data,\n        label: data,\n      }\n    })\n    categoryOptions.value = (res.data.data.categoryList ?? []).map((data: string) => {\n      return {\n        value: data,\n        label: data,\n      }\n    })\n  } else {\n    message.error('加载选项失败，' + res.data.message)\n  }\n}\n\nonMounted(() => {\n  getTagCategoryOptions()\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"})","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"FffJdIXspo0FKdxawh3ckzCRn9f","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"5）空间详情页使用组件：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"F3X5dW1g4oyj2gxaCw0ck1VTnUh","block_type":14,"code":{"elements":[{"text_run":{"content":"<!-- 搜索表单 -->\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"<PictureSearchForm />","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"CW63dZWVRoqTa2xv97ecI8Rhnoh","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"浏览效果，目前表单项都挤在一起，不太好看","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"LbkRdrEzVoNZsmxeVEbctLsCnob","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"可以添加 CSS 样式，增加上边距：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WSaxduIq3oBf2fxTlOsci1VnnCc","block_type":14,"code":{"elements":[{"text_run":{"content":".picture-search-form .ant-form-item {\n  margin-top: 16px;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":12,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"KNpyd7jMPotdkYxjbMkcEOUEnPg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"6）由于数؜字输入框的值无法直接通过 allow-clear 清理，所以给表单增加一个重置按钮。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HFG2dFzTboyYCVxAQ9Sc3EGSnKN","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"页面代码：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"SuwpdFKN9oTf18xmqk4cnvH7npc","block_type":14,"code":{"elements":[{"text_run":{"content":"<a-form-item>\n  <a-space>\n    <a-button type=\"primary\" html-type=\"submit\" style=\"width: 96px\">搜索</a-button>\n    <a-button html-type=\"reset\" @click=\"doClear\">重置</a-button>\n  </a-space>\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</a-form-item>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Cm4bdFKzXoO3w5xfc0Tc6DtenKw","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"需要编写一个重置函数，将所有搜索条件的值清空。由于我们使用了 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"reactive","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 响应式变量，无法直接整体赋值为一个空对象，而是需要将其中的字段全部设置为空。此外，不要忘了日期组件的值也需要重置为空数组。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"ULIudzxAUorgc4xUocDchkWwnJf","block_type":14,"code":{"elements":[{"text_run":{"content":"// 清理const doClear = () => {\n  // 取消所有对象的值Object.keys(searchParams).forEach((key) => {\n    searchParams[key] = undefined\n  })\n  dateRange.value = []\n  props.onSearch?.(searchParams)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"GevGd1VLfomEmdx94mscC07vnjc","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"效果如图：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"N46BdEqWvo0YVtxj8xbcWn1wnie","block_type":27,"image":{"align":2,"height":99,"token":"XVpGbmpQroIS4RxwhXMcAnU3nlc","width":1473},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"RgR5dgEPnoQkfNxudYecLUFFn1d","block_type":5,"heading3":{"elements":[{"text_run":{"content":"2、执行搜索","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"WpHXdgc96oFw7Vxt13OcPneRnib","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）给组件传递 onSearch 搜索函数：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"TKFvd32xdoAST9xwqOac9TeynHe","block_type":14,"code":{"elements":[{"text_run":{"content":"<!-- 搜索表单 -->\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"<PictureSearchForm :onSearch=\"onSearch\" />","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"RWVMdsprmopt2lxoDD8cGbolnrf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）编写搜索函数","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Xb6qd81bYonY1nx7Qtnceza6nDf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"由于搜索参数可能؜被重置，为了方便，将 searchParams 从 reactive 变量改为 ref 变量，这样可以整体给 searchParams 赋值为空的对象。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JUuedjERtoT3kKxFhEVcxEzmntg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"要修改的代码如下：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"COwRd7Y75oRjlAx5JkCczWcSnrc","block_type":14,"code":{"elements":[{"text_run":{"content":"// 搜索条件const searchParams = ref<API.PictureQueryRequest>({\n  current: 1,\n  pageSize: 12,\n  sortField: 'createTime',\n  sortOrder: 'descend',\n})\n\n// 分页参数const onPageChange = (page, pageSize) => {\n  searchParams.value.current = page\n  searchParams.value.pageSize = pageSize\n  fetchData()\n}\n\n// 搜索const onSearch = (newSearchParams: API.PictureQueryRequest) => {\n  searchParams.value = {\n    ...searchParams.value,\n    ...newSearchParams,\n    current: 1,\n  }\n  fetchData()\n}\n\n// 获取数据const fetchData = async () => {\n  loading.value = true// 转换搜索参数const params = {\n    spaceId: props.id,\n    ...searchParams.value,\n  }\n  const res = await listPictureVoByPageUsingPost(params)\n  if (res.data.data) {\n    dataList.value = res.data.data.records ?? []\n    total.value = res.data.data.total ?? 0\n  } else {\n    message.error('获取数据失败，' + res.data.message)\n  }\n  loading.value = false\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Lk2Pd3AMCoKb7AxrsOgcHzfxnAc","block_type":22,"divider":{},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"PrUAdl9Nwofwi3xm9SZcrKKin3c","block_type":3,"heading1":{"elements":[{"text_run":{"content":"图片搜索——以图搜图","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"VIledqTOfohDZPxAeILct8Y8nTc","block_type":4,"heading2":{"elements":[{"text_run":{"content":"需求分析","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"QYaWdDZA0oBr0kxGAebc3gq6nNc","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"用户可以使؜用一张图片来搜索相似的图片，相比传统的关键词搜索，能够更精确地找到与上传图片内容相似的图片。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"D9WVdXuZJo6twjxvEcEctHrInbc","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"为了获得更多的搜索结果，我们的需求是从 全网搜索图片，而不是只在自己的图库中搜索。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"LhnXd3NYDomPWcxATUKc27Ilnvg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"注意，该功能不用局限于私有空间，公共图库也可以使用。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"SYGXdT90Po6hNxxqCiNc9tcOn5f","block_type":4,"heading2":{"elements":[{"text_run":{"content":"方案设计","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"D9TndXjQqok56cxC3e9c4Dp2nvg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"主要有 2 种方案：第三方 API 以及数据抓取（爬虫）","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GbWxdgJehoVKrSx1r4fcCL7SnSh","block_type":5,"heading3":{"elements":[{"text_run":{"content":"1、第三方 API","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"GgoudDlEjoG12XxF0Cicnvr0nZd","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"如果想从自建的图库中搜索：可以使用百度 AI 提供的图片搜索 API，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"参考官方文档","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fai.baidu.com%2Ftech%2Fimagesearch%2F"},"strikethrough":false,"text_color":5,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MW71dfsfeor8UxxnjTgcujfqnqd","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"Bing 以图搜图 API： 利用必应的图库，可以从全网进行搜索，而且可以免费使用，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"参考官方文档","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fbing%2Fsearch-apis%2Fbing-image-search%2Fquickstarts%2Frest%2Fjava"},"strikethrough":false,"text_color":5,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"LDJ0dwU7uourOixMoHYcEScOnEh","block_type":5,"heading3":{"elements":[{"text_run":{"content":"2、数据抓取","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"FbmQdW33CoJ8DcxWMphcxilyn9g","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"利用已有的؜以图搜图网站，通过数据抓取的方式实时查询搜图网站的返回结果。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WIQadAa0Xow8YhxKwKkcazgUnWc","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"为了让大家学习到更多知识，此处我们选择这种方案。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"AbWudKWHWoFxjyxAButcANfdnfc","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"以百度搜图؜网站为例，我们可以先体验一遍流程，并且对接口进行分析：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Yof5dH54Lo8s0lx383GcGEdQnll","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）进到百度图片搜索，通过 url 上传图片，发现接口：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"https://graph.baidu.com/upload?uptime=","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fgraph.baidu.com%2Fupload%3Fuptime%3D"},"strikethrough":false,"text_color":5,"underline":false}}},{"text_run":{"content":" ，该接口的返回值为 “以图搜图的页面地址”","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Nx48dZMdco1AvVxmwx1ct7nwnjh","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）访问上一步得到的 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"页面地址","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fgraph.baidu.com%2Fs%3Fcard_key%3D%26entrance%3DGENERAL%26extUiData%255BisLogoShow%255D%3D1%26f%3Dall%26isLogoShow%3D1%26session_id%3D16250747570487381669%26sign%3D1265ce97cd54acd88139901733452612%26tpl_from%3Dpc"},"strikethrough":false,"text_color":5,"underline":false}}},{"text_run":{"content":"，可以在返回值中找到 firstUrl：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Ukq0dYIPuoBjQrxWy72cu9pynHb","block_type":27,"image":{"align":2,"height":552,"token":"QydmbLwDzoFN9JxLU52cSpT4n5f","width":1757},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"SuFIdGxxaoaweex9aqUccoRLnFf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"3）访问 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"firstUrl","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fgraph.baidu.com%2Fajax%2Fpcsimi%3Fcarousel%3D503%26entrance%3DGENERAL%26extUiData%255BisLogoShow%255D%3D1%26inspire%3Dgeneral_pc%26limit%3D30%26next%3D2%26render_type%3Dcard%26session_id%3D16250747570487381669%26sign%3D1265ce97cd54acd88139901733452612%26tk%3D4caaa%26tpl_from%3Dpc"},"strikethrough":false,"text_color":5,"underline":false}}},{"text_run":{"content":"，就能得到 JSON 格式的相似图片列表，里面包含了图片的缩略图和原图地址：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KDkTdhsQhopXsRxCjdWcb84xnbd","block_type":27,"image":{"align":2,"height":684,"token":"FqvLboqonotpFAxdSpEc3TNPn7f","width":1354},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"ZNnedkUfvojLbaxmx1icbtL1n8c","block_type":4,"heading2":{"elements":[{"text_run":{"content":"后端开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"QtbDdukVAo0fYFxnuFwcNdGQnge","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"新建 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"api","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 包，由于项目可能会用到多个 api，可以将每个 api 都放在 api 目录下的一个包中。比如图片搜索 api 的相关代码，全部放在 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"api.imagesearch","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 包下。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"DOcTdIIHXo0qrBxC14gcKZITnFg","block_type":5,"heading3":{"elements":[{"text_run":{"content":"1、数据模型开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"IjeYd1lJEoMEvyx6Ow3cUQVFneg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"在 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"imagesearch.model","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 包中，新建一个图片搜索结果类，用于接受 API 的返回值：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"FinddaOGnoUqdlxheEecb9TLnib","block_type":14,"code":{"elements":[{"text_run":{"content":"@Datapublic class ImageSearchResult {\n\n    /**\n     * 缩略图地址\n     */private String thumbUrl;\n\n    /**\n     * 来源地址\n     */private String fromUrl;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"MYaJdzFGuoTp0QxiLoNcufjZnDd","block_type":5,"heading3":{"elements":[{"text_run":{"content":"2、API 开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"JedGdOmyro3VIoxaUbHc6v6dnIf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"根据方案，我们要调用多个 API，每个子 API 可以作为一个静态类来实现，统一放在 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"imagesearch.sub","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 包中，并且每个类都包含一个 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"main","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 方法，用于进行本地测试。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KMgzd4D5OoNfWVxpf1ychHITnPf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）获取以图搜图的页面地址","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JrSfdqelLoY4ztxl7tZcdOMtnLf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"通过向百度؜发送 POST 请求，获取给定图片 URL 的相似图片页面地址。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CFzMdAe6BoPQbwxg0zLcvsJhnje","block_type":14,"code":{"elements":[{"text_run":{"content":"@Slf4jpublic class GetImagePageUrlApi {\n\n    /**\n     * 获取图片页面地址\n     *\n     * @param imageUrl\n     * @return\n     */public static String getImagePageUrl(String imageUrl) {\n        // 1. 准备请求参数\n        Map<String, Object> formData = new HashMap<>();\n        formData.put(\"image\", imageUrl);\n        formData.put(\"tn\", \"pc\");\n        formData.put(\"from\", \"pc\");\n        formData.put(\"image_source\", \"PC_UPLOAD_URL\");\n        // 获取当前时间戳long uptime = System.currentTimeMillis();\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        // 请求地址String url = \"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"https://graph.baidu.com/upload?uptime=","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"\" + uptime;\n\n        try {\n            // 2. 发送 POST 请求到百度接口HttpResponse response = HttpRequest.post(url)\n                    .form(formData)\n                    .timeout(5000)\n                    .execute();\n            // 判断响应状态if (HttpStatus.HTTP_OK != response.getStatus()) {\n                throw new BusinessException(ErrorCode.OPERATION_ERROR, \"接口调用失败\");\n            }\n            // 解析响应String responseBody = response.body();\n            Map<String, Object> result = JSONUtil.toBean(responseBody, Map.class);\n\n            // 3. 处理响应结果if (result == null || !Integer.valueOf(0).equals(result.get(\"status\"))) {\n                throw new BusinessException(ErrorCode.OPERATION_ERROR, \"接口调用失败\");\n            }\n            Map<String, Object> data = (Map<String, Object>) result.get(\"data\");\n            String rawUrl = (String) data.get(\"url\");\n            // 对 URL 进行解码String searchResultUrl = URLUtil.decode(rawUrl, StandardCharsets.UTF_8);\n            // 如果 URL 为空if (searchResultUrl == null) {\n                throw new BusinessException(ErrorCode.OPERATION_ERROR, \"未返回有效结果\");\n            }\n            return searchResultUrl;\n        } catch (Exception e) {\n            log.error(\"搜索失败\", e);\n            throw new BusinessException(ErrorCode.OPERATION_ERROR, \"搜索失败\");\n        }\n    }\n\n    public static void main(String[] args) {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        // 测试以图搜图功能String imageUrl = \"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"https://www.codefather.cn/logo.png","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"\";\n        String result = getImagePageUrl(imageUrl);\n        System.out.println(\"搜索成功，结果 URL：\" + result);\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"GfrJdrHknoGAwnxQbAaczX6GnKe","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）获取图片列表页面地址","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"NIkBdLqTPoy5jxxDogiclNQ4nuc","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"通过 jsoup 爬取 HTML 页面，提取其中包含 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"firstUrl","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 的 JavaScript 脚本，并返回图片列表的页面地址。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"YM7MduojpoQ2BExVPjicB9DonPd","block_type":14,"code":{"elements":[{"text_run":{"content":"@Slf4jpublic class GetImageFirstUrlApi {\n\n    /**\n     * 获取图片列表页面地址\n     *\n     * @param url\n     * @return\n     */public static String getImageFirstUrl(String url) {\n        try {\n            // 使用 Jsoup 获取 HTML 内容Document document = Jsoup.connect(url)\n                    .timeout(5000)\n                    .get();\n\n            // 获取所有 <script> 标签Elements scriptElements = document.getElementsByTag(\"script\");\n\n            // 遍历找到包含 `firstUrl` 的脚本内容for (Element script : scriptElements) {\n                String scriptContent = script.html();\n                if (scriptContent.contains(\"\\\"firstUrl\\\"\")) {\n                    // 正则表达式提取 firstUrl 的值Pattern pattern = Pattern.compile(\"\\\"firstUrl\\\"\\\\s*:\\\\s*\\\"(.*?)\\\"\");\n                    Matcher matcher = pattern.matcher(scriptContent);\n                    if (matcher.find()) {\n                        String firstUrl = matcher.group(1);\n                        // 处理转义字符\n                        firstUrl = firstUrl.replace(\"\\\\/\", \"/\");\n                        return firstUrl;\n                    }\n                }\n            }\n\n            throw new BusinessException(ErrorCode.OPERATION_ERROR, \"未找到 url\");\n        } catch (Exception e) {\n            log.error(\"搜索失败\", e);\n            throw new BusinessException(ErrorCode.OPERATION_ERROR, \"搜索失败\");\n        }\n    }\n\n    public static void main(String[] args) {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        // 请求目标 URLString url = \"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"https://graph.baidu.com/s?card_key=&entrance=GENERAL&extUiData[isLogoShow]=1&f=all&isLogoShow=1&session_id=16250747570487381669&sign=1265ce97cd54acd88139901733452612&tpl_from=pc","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"\";\n        String imageFirstUrl = getImageFirstUrl(url);\n        System.out.println(\"搜索成功，结果 URL：\" + imageFirstUrl);\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"YqEeddmrco398Wx95H2cRHCmn8d","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"3）获取图片列表","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"J8BSdwiCho6z8oxZnvYci8Uen2f","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"通过调用百؜度接口返回的 JSON 数据，提取出其中的图片列表并返回。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WeD8dI0UZoAjz0xIp90ctxU9n8f","block_type":14,"code":{"elements":[{"text_run":{"content":"@Slf4jpublic class GetImageListApi {\n\n    /**\n     * 获取图片列表\n     *\n     * @param url\n     * @return\n     */public static List<ImageSearchResult> getImageList(String url) {\n        try {\n            // 发起GET请求HttpResponse response = HttpUtil.createGet(url).execute();\n\n            // 获取响应内容int statusCode = response.getStatus();\n            String body = response.body();\n\n            // 处理响应if (statusCode == 200) {\n                // 解析 JSON 数据并处理return processResponse(body);\n            } else {\n                throw new BusinessException(ErrorCode.OPERATION_ERROR, \"接口调用失败\");\n            }\n        } catch (Exception e) {\n            log.error(\"获取图片列表失败\", e);\n            throw new BusinessException(ErrorCode.OPERATION_ERROR, \"获取图片列表失败\");\n        }\n    }\n\n    /**\n     * 处理接口响应内容\n     *\n     * @param responseBody 接口返回的JSON字符串\n     */private static List<ImageSearchResult> processResponse(String responseBody) {\n        // 解析响应对象JSONObject jsonObject = new JSONObject(responseBody);\n        if (!jsonObject.containsKey(\"data\")) {\n            throw new BusinessException(ErrorCode.OPERATION_ERROR, \"未获取到图片列表\");\n        }\n        JSONObject data = jsonObject.getJSONObject(\"data\");\n        if (!data.containsKey(\"list\")) {\n            throw new BusinessException(ErrorCode.OPERATION_ERROR, \"未获取到图片列表\");\n        }\n        JSONArray list = data.getJSONArray(\"list\");\n        return JSONUtil.toList(list, ImageSearchResult.class);\n    }\n\n    public static void main(String[] args) {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        String url = \"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"https://graph.baidu.com/ajax/pcsimi?carousel=503&entrance=GENERAL&extUiData%5BisLogoShow%5D=1&inspire=general_pc&limit=30&next=2&render_type=card&session_id=16250747570487381669&sign=1265ce97cd54acd88139901733452612&tk=4caaa&tpl_from=pc","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"\";\n        List<ImageSearchResult> imageList = getImageList(url);\n        System.out.println(\"搜索成功\" + imageList);\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"KC8wd2fKZo2OWXxyywJclkG9nZe","block_type":5,"heading3":{"elements":[{"text_run":{"content":"3、图片搜索服务（门面模式）","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"WJ3ZdJeQTo2egvxtGyucHmIqnFe","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"这里我们运用؜一种设计模式来提供图片搜索服务。门面模式通过提供一个统一的接口来简化多个接口的调用，使得客户端不需要关注内部的具体实现。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Sqo8dbD9yowKshxqqgCcRJekn4e","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"我们可以将多个 API 整合到一个门面类中，简化调用过程。在 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"imagesearch","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 包下新建门面类，整合几个接口的调用：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"PP6SdtgdBoSuGoxaew6cKK1tnaf","block_type":14,"code":{"elements":[{"text_run":{"content":"@Slf4jpublic class ImageSearchApiFacade {\n\n    /**\n     * 搜索图片\n     *\n     * @param imageUrl\n     * @return\n     */public static List<ImageSearchResult> searchImage(String imageUrl) {\n        String imagePageUrl = GetImagePageUrlApi.getImagePageUrl(imageUrl);\n        String imageFirstUrl = GetImageFirstUrlApi.getImageFirstUrl(imagePageUrl);\n        List<ImageSearchResult> imageList = GetImageListApi.getImageList(imageFirstUrl);\n        return imageList;\n    }\n\n    public static void main(String[] args) {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        // 测试以图搜图功能String imageUrl = \"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"https://www.codefather.cn/logo.png","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"\";\n        List<ImageSearchResult> resultList = searchImage(imageUrl);\n        System.out.println(\"结果列表\" + resultList);\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Y5ccdHCbYouxG4xkbQIcqMYrnxc","block_type":5,"heading3":{"elements":[{"text_run":{"content":"4、接口开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Ok4GdIdHConn2XxXe0Sce4minHg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"开发请求类：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"K5RVdHN0IooxLIxSHzvcgBfHncc","block_type":14,"code":{"elements":[{"text_run":{"content":"@Datapublic class SearchPictureByPictureRequest implements Serializable {\n\n    /**\n     * 图片 id\n     */private Long pictureId;\n\n    private static final long serialVersionUID = 1L;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"NzRxd9UDPoxgdnxQnrsc2lzyn3f","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"开发接口：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Qtdddj09toZKZWxGTNOc4ICdnVg","block_type":14,"code":{"elements":[{"text_run":{"content":"/**\n * 以图搜图\n */@PostMapping(\"/search/picture\")public BaseResponse<List<ImageSearchResult>> searchPictureByPicture(@RequestBody SearchPictureByPictureRequest searchPictureByPictureRequest) {\n    ThrowUtils.throwIf(searchPictureByPictureRequest == null, ErrorCode.PARAMS_ERROR);\n    Long pictureId = searchPictureByPictureRequest.getPictureId();\n    ThrowUtils.throwIf(pictureId == null || pictureId <= 0, ErrorCode.PARAMS_ERROR);\n    Picture oldPicture = pictureService.getById(pictureId);\n    ThrowUtils.throwIf(oldPicture == null, ErrorCode.NOT_FOUND_ERROR);\n    List<ImageSearchResult> resultList = ImageSearchApiFacade.searchImage(oldPicture.getUrl());\n    return ResultUtils.success(resultList);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"WFhNdKOGfob7WyxBylfcPGVMnab","block_type":4,"heading2":{"elements":[{"text_run":{"content":"前端开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"DbH0dARhxoMZpxxk03ccEfdsnse","block_type":5,"heading3":{"elements":[{"text_run":{"content":"1、搜索入口","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"RDAZdqrO4oHZhUxPGoEc3DUMn1l","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）修改图片列表页面的代码，给图片操作栏增加一个搜索按钮：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Jv9mdyO4doyL1JxrmchcD5kvnSb","block_type":14,"code":{"elements":[{"text_run":{"content":"<template v-if=\"showOp\" #actions>\n  <a-space @click=\"(e) => doSearch(picture, e)\">\n    <search-outlined />\n    搜索\n  </a-space>\n  <a-space @click=\"(e) => doEdit(picture, e)\">\n    <edit-outlined />\n    编辑\n  </a-space>\n  <a-space @click=\"(e) => doDelete(picture, e)\">\n    <delete-outlined />\n    删除\n  </a-space>\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</template>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"KdImdDxO9o05Jox0XP5cEUapn6d","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）点击搜索后打开新页面，进入到以图搜图结果页：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Vm0vdRWswoL9Vnx0agkc68knnbd","block_type":14,"code":{"elements":[{"text_run":{"content":"// 搜索const doSearch = (picture, e) => {\n  e.stopPropagation()\n  window.open(`/search_picture?pictureId=${picture.id}`)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"ZcLGdqMELogLmax6UREcXRdTn5f","block_type":5,"heading3":{"elements":[{"text_run":{"content":"2、以图搜图结果页面","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"XLNhd8X2iotDd5xKwYIcNcMtnjc","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）新建图片搜索页面文件 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"SearchPicturePage.vue","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。可以复制创建图片页面，这样可以复用获取 url 查询参数并查询老数据的逻辑。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"VjWqdwsZqoC6JyxU6HQcVrpEn0c","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"添加路由：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Xa3LdS3AHo241Px1Brmc8YeUnzb","block_type":14,"code":{"elements":[{"text_run":{"content":"{\n  path: '/search_picture',\n  name: '图片搜索',\n  component: SearchPicturePage,\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"FE6ud9XjbogxBAxgAjccq9Z5nff","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）开发页؜面，上方展示页面标题和原始图片，下方展示搜索结果图片列表。可以参考图片列表组件来展示图片列表：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"G4ycddNAOoHjePxjuIwcyIxsnqf","block_type":14,"code":{"elements":[{"text_run":{"content":"<template>\n  <div id=\"searchPicturePage\">\n    <h2 style=\"margin-bottom: 16px\">以图搜图</h2>\n    <h3 style=\"margin: 16px 0\">原图</h3>\n    <a-card style=\"width: 240px\">\n      <template #cover>\n        <img\n          style=\"height: 180px; object-fit: cover\"\n          :alt=\"picture.name\"\n          :src=\"picture.thumbnailUrl ?? picture.url\"\n        />\n      </template>\n    </a-card>\n    <h3 style=\"margin: 16px 0\">识图结果</h3>\n    <!-- 图片列表 -->\n    <a-list\n      :grid=\"{ gutter: 16, xs: 1, sm: 2, md: 3, lg: 4, xl: 5, xxl: 6 }\"\n      :data-source=\"dataList\"\n    >\n      <template #renderItem=\"{ item }\">\n        <a-list-item style=\"padding: 0\">\n          <a :href=\"item.fromUrl\" target=\"_blank\">\n            <a-card>\n              <template #cover>\n                <img style=\"height: 180px; object-fit: cover\" :src=\"item.thumbUrl\" />\n              </template>\n            </a-card>\n          </a>\n        </a-list-item>\n      </template>\n    </a-list>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, ref } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { getPictureVoByIdUsingGet, searchPictureByPictureUsingPost } from '@/api/pictureController'\nimport { message } from 'ant-design-vue'\n\nconst route = useRoute()\n\n// 图片 id\nconst pictureId = computed(() => {\n  return route.query?.pictureId\n})\n\nconst picture = ref<API.PictureVO>({})\n\n// 获取老数据\nconst getOldPicture = async () => {\n  // 获取数据\n  const id = route.query?.pictureId\n  if (id) {\n    const res = await getPictureVoByIdUsingGet({\n      id: id,\n    })\n    if (res.data.code === 0 && res.data.data) {\n      const data = res.data.data\n      picture.value = data\n    }\n  }\n}\n\nonMounted(() => {\n  getOldPicture()\n})\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</script>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"S6sldvYvtoObl8x7xfvc0wtVnsf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"3）获取图片搜索结果：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GnpSdrGoIorDPLx8mQ5cfo0gn9f","block_type":14,"code":{"elements":[{"text_run":{"content":"const dataList = ref<API.ImageSearchResult[]>([])\n// 获取搜图结果const fetchData = async () => {\n  const res = await searchPictureByPictureUsingPost({\n    pictureId: pictureId.value,\n  })\n  if (res.data.code === 0 && res.data.data) {\n    dataList.value = res.data.data ?? []\n  } else {\n    message.error('获取数据失败，' + res.data.message)\n  }\n}\n\n// 页面加载时请求一次onMounted(() => {\n  fetchData()\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"})","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Kb71dIjG1oQ2Uxx778PcODCmnt2","block_type":4,"heading2":{"elements":[{"text_run":{"content":"测试","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"MOikdizxioc4KMxzbMtcawJCnOe","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"经过测试发؜现，百度搜索对于 webp 格式图片的支持度并不好（改文件的后缀也没有用），估计是平台不支持该格式的算法。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"NoDFdAmiLo8AbHxo1KIcgmr6n4b","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"但是使用 png 图片去测试，就能正常看到结果了：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CcRVd2h8lorDxHxlUpJcetLfnMf","block_type":27,"image":{"align":2,"height":834,"token":"UG1UbDZFloqdPuxjFlyccFT3nbh","width":1884},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"XXs4dafJfoeIa4xH6ydckOHsnLf","block_type":22,"divider":{},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"El61d70wpobgjmxoJNgcJRg8nlb","block_type":3,"heading1":{"elements":[{"text_run":{"content":"图片搜索——颜色搜索","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"WLcndjNr5o40y8xSrPccibQ2n0c","block_type":4,"heading2":{"elements":[{"text_run":{"content":"需求分析","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"GjBJdkL4HoM8YxxiODBcPpZ8nyf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"能够按照颜色搜索空间内 主色调 最相似的图片，在设计、创意和电商领域有广泛应用。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"SWnndBRZvoQ9t2x2kOfcI51DnFd","block_type":4,"heading2":{"elements":[{"text_run":{"content":"方案设计","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Irlfdm1eLoYG2wxz5o4cxwzPnsb","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"需要思考几个问题：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"PT3DdChL0o5pnAxMp3hcuDshnbg","block_type":13,"ordered":{"elements":[{"text_run":{"content":"整体业务流程","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"1"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"DMfnd5X3so0Nz0x2t7xc6LRBnxh","block_type":13,"ordered":{"elements":[{"text_run":{"content":"怎么获取图片主色调？","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"A0hhdG6buoDhDHxCvKacnFuAnBS","block_type":13,"ordered":{"elements":[{"text_run":{"content":"怎么设计搜索算法？","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"AtF0dw5FyoytkTxI2lRc8WsJnxB","block_type":5,"heading3":{"elements":[{"text_run":{"content":"1、整体流程","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"PqhEdPEaioN8vDxivREcGVoYngn","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"为了提升性؜能，避免每次搜索都实时计算图片主色调，建议在图片上传成功后立即提取主色调并存储到数据库的独立字段中。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"G5h5d1mWgo4EPdxC2adcvVF4nGd","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"完整流程如下：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"SfQgdd0H8oBWkmxHSPsc9oomnTg","block_type":13,"ordered":{"elements":[{"text_run":{"content":"提取图片颜色：通过图像处理技术（云服务 API 或者 OpenCV 图像处理库）提取图片的颜色特征，可以采用主色调、颜色直方图等方法表示图片的颜色特征。此处我们采用主色调，便于理解。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"1"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Xghkdlgnboz9yaxUOIOcxqiJnsf","block_type":13,"ordered":{"elements":[{"text_run":{"content":"存储颜色特征：将提取的颜色数据存储到数据库中，以便后续快速检索。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"W7KXd3jrooxfRMxgUYNcKnZYn2d","block_type":13,"ordered":{"elements":[{"text_run":{"content":"用户查询输入：用户通过颜色选择器、RGB 值输入、或预定义颜色名称指定颜色查询条件。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"ExHEdZvwyoF7zpxVq4gcqyUtnyh","block_type":13,"ordered":{"elements":[{"text_run":{"content":"计算相似度：根据用户指定的颜色，与数据库中的颜色特征进行相似度计算（如欧氏距离、余弦相似度等方法）。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"D2G8dd3ZRoiluJx5LERcxkuWnlf","block_type":13,"ordered":{"elements":[{"text_run":{"content":"返回结果：由于空间内的图片数量相对较少，可以按照图片与目标颜色的相似度进行排序，优先返回最符合用户要求的图片，而不是仅返回完全符合指定色调的图片。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Rjf7dHflaoZmLfxbjuFchtfOnOe","block_type":5,"heading3":{"elements":[{"text_run":{"content":"2、怎么获取图片主色调？","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"QslcdTcDGod6fRxQxuzcBD48nZb","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"我们存储图片使用的 COS 对象存储服务已经帮我们整合了数据万象，自带获取图片主色调的功能，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"参考文档","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fcloud.tencent.com%2Fdocument%2Fproduct%2F460%2F6928"},"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"U5lWdEhqGoj5E3xENabciU9fn3f","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"💡 在使用云服务功能前，我们可以详细了解下服务的相关限制，比如 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"数据万象的限制","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fcloud.tencent.com%2Fdocument%2Fproduct%2F460%2F36620"},"strikethrough":false,"underline":false}}},{"text_run":{"content":"，一般情况下达不到限制。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WDphdJkjAoiH7Exjnt7cTTo3nLf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"除了方便之؜外，这个功能属于基础图片处理，官方提供的免费额度较高，适合学习测试：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MOxKdufEMoguTPxrVvqcQUTQnXS","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"💡 一般我们做项目时，؜尽可能减少新依赖或服务的引入，会让成本更可控。比如看到腾讯云 COS 有现成的支持和免费额度，就已经是我们的首选解决方案，无需考虑第三方 API，可能会带来的额外限制和兼容性问题（比如我们的图片开启防盗链，可能就解析不到）。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Ryy2dEirso1UyRx07bGcEonpnAh","block_type":5,"heading3":{"elements":[{"text_run":{"content":"3、如何计算颜色相似度？","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"KeBOd5cStotUxFxwuSxcEBe8nih","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"数据库不支؜持直接按照颜色检索，用 like 检索又不符合颜色的特性。所以可以使用一些算法来解决。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"DmA4dihQfo7qdDxSX6hcFbFSnfe","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"此处使用 欧几里得距离 算法：颜色可以用 RGB 值表示，可以通过计算两种颜色 RGB 值之间的欧几里得距离来判断它们的相似度。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"TxhndbjJLo7hWFxeHWYcsFlhnBq","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"距离越小，表示颜色越相似；距离越大，表示颜色越不同。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"A8wAdwE96oK5m5xFooVcTdsZn4b","block_type":4,"heading2":{"elements":[{"text_run":{"content":"后端开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"SnOAdBoyloY8JXxSeeccCC9rn0d","block_type":5,"heading3":{"elements":[{"text_run":{"content":"1、补充颜色字段","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"EUAHdDlLRohueJx67NkcKgvwnWf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）图片表新增字段，执行 SQL：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"X2kHd0rrooKM37xIS5QctcXln8f","block_type":14,"code":{"elements":[{"text_run":{"content":"ALTER TABLE picture\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ADD COLUMN picColor varchar(16) null comment '图片主色调';","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":56,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"V1MrdKagGoEJz3xM0Zxcw6w9nsb","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）每次新增字段时，都要修改 PictureMapper.xml 以支持新字段的查询。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"EDN2dEVbYoxZLXxIXztcJI8enyd","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"Pictur؜e 实体类、PictureVO 包装类、UploadPictureResult 上传图片结果类也需要补充新字段：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Y9NzdeGkeoH26UxPtiXcAq03n5g","block_type":14,"code":{"elements":[{"text_run":{"content":"/**\n * 图片主色调\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" */private String picColor;","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"GfvLdq3kkocDMMx1iS6cjjV5nGX","block_type":5,"heading3":{"elements":[{"text_run":{"content":"2、存储颜色","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"CTUKd21spoDFw1xUvNjcGf1snME","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）修改 P؜ictureUploadTemplate 的 buildResult 方法，直接从 ImageInfo 对象中就能获得主色调：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"TQPmdppJ2oL2HzxmNFWcG5jIn2d","block_type":14,"code":{"elements":[{"text_run":{"content":"uploadPictureResult.setPicColor(imageInfo.getAve());","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"QRwXdNZ46oR1Vnxk95rcoLELnle","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"注意两个 b؜uildResult 方法都要修改，其中一个 buildResult 方法要补充 imageInfo 参数，修改的代码如下：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"QarcdXgx4oXbdkx4aghcS0Dtnze","block_type":14,"code":{"elements":[{"text_run":{"content":"private UploadPictureResult buildResult(String originFilename, CIObject compressedCiObject, CIObject thumbnailCiObject, ImageInfo imageInfo) {\n    UploadPictureResult uploadPictureResult = new UploadPictureResult();\n    int picWidth = compressedCiObject.getWidth();\n    int picHeight = compressedCiObject.getHeight();\n    double picScale = NumberUtil.round(picWidth * 1.0 / picHeight, 2).doubleValue();\n    uploadPictureResult.setPicName(FileUtil.mainName(originFilename));\n    uploadPictureResult.setPicWidth(picWidth);\n    uploadPictureResult.setPicHeight(picHeight);\n    uploadPictureResult.setPicScale(picScale);\n    uploadPictureResult.setPicFormat(compressedCiObject.getFormat());\n    uploadPictureResult.setPicColor(imageInfo.getAve());\n    uploadPictureResult.setPicSize(compressedCiObject.getSize().longValue());\n    // 设置图片为压缩后的地址\n    uploadPictureResult.setUrl(cosClientConfig.getHost() + \"/\" + compressedCiObject.getKey());\n    // 设置缩略图\n    uploadPictureResult.setThumbnailUrl(cosClientConfig.getHost() + \"/\" + thumbnailCiObject.getKey());\n    return uploadPictureResult;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"QmAOdBncjoDrw8xyvYVcm6kQnnd","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）图片服؜务的 uploadPicture 中补充设置 picColor，从而将该字段保存到数据库中：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"O4VrduugboWBxQxwEfyc2FlBn4b","block_type":14,"code":{"elements":[{"text_run":{"content":"picture.setPicColor(uploadPictureResult.getPicColor());","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Ja5Mddcynout3JxeCBHc80Qlnwh","block_type":5,"heading3":{"elements":[{"text_run":{"content":"3、颜色相似度计算","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"RZ7NdTLXHodv2dxlTHecRkebnQz","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"新建 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"utils","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 包，直接利用 AI 来编写工具类：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RabWdiy4GoYHwIxNFy1cmxKxnwf","block_type":14,"code":{"elements":[{"text_run":{"content":"/**\n * 工具类：计算颜色相似度\n */public class ColorSimilarUtils {\n\n    private ColorSimilarUtils() {\n        // 工具类不需要实例化\n    }\n\n    /**\n     * 计算两个颜色的相似度\n     *\n     * @param color1 第一个颜色\n     * @param color2 第二个颜色\n     * @return 相似度（0到1之间，1为完全相同）\n     */public static double calculateSimilarity(Color color1, Color color2) {\n        int r1 = color1.getRed();\n        int g1 = color1.getGreen();\n        int b1 = color1.getBlue();\n\n        int r2 = color2.getRed();\n        int g2 = color2.getGreen();\n        int b2 = color2.getBlue();\n\n        // 计算欧氏距离double distance = Math.sqrt(Math.pow(r1 - r2, 2) + Math.pow(g1 - g2, 2) + Math.pow(b1 - b2, 2));\n\n        // 计算相似度return 1 - distance / Math.sqrt(3 * Math.pow(255, 2));\n    }\n\n    /**\n     * 根据十六进制颜色代码计算相似度\n     *\n     * @param hexColor1 第一个颜色的十六进制代码（如 0xFF0000）\n     * @param hexColor2 第二个颜色的十六进制代码（如 0xFE0101）\n     * @return 相似度（0到1之间，1为完全相同）\n     */public static double calculateSimilarity(String hexColor1, String hexColor2) {\n        Color color1 = Color.decode(hexColor1);\n        Color color2 = Color.decode(hexColor2);\n        return calculateSimilarity(color1, color2);\n    }\n\n    // 示例代码public static void main(String[] args) {\n        // 测试颜色Color color1 = Color.decode(\"0xFF0000\");\n        Color color2 = Color.decode(\"0xFE0101\");\n        double similarity = calculateSimilarity(color1, color2);\n\n        System.out.println(\"颜色相似度为：\" + similarity);\n\n        // 测试十六进制方法double hexSimilarity = calculateSimilarity(\"0xFF0000\", \"0xFE0101\");\n        System.out.println(\"十六进制颜色相似度为：\" + hexSimilarity);\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"ApVPds0E4oMOIIxiszqcVzYpnIe","block_type":5,"heading3":{"elements":[{"text_run":{"content":"4、颜色查询服务","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Lb4sdcnqMoAyZzxxkAQcGJKbnDb","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"为了让大家学؜习更清晰，在图片服务中新编写按颜色查询图片的方法 searchPictureByColor，不和其他的搜索条件放在一起。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"O7zsdG6NMoWviGx6CCZcgi97n9f","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"按照方案设计中的流程开发，代码如下：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CSi8db906oXV7cxFWhFcovDjnKh","block_type":14,"code":{"elements":[{"text_run":{"content":"@Overridepublic List<PictureVO> searchPictureByColor(Long spaceId, String picColor, User loginUser) {\n    // 1. 校验参数\n    ThrowUtils.throwIf(spaceId == null || StrUtil.isBlank(picColor), ErrorCode.PARAMS_ERROR);\n    ThrowUtils.throwIf(loginUser == null, ErrorCode.NO_AUTH_ERROR);\n    // 2. 校验空间权限Space space = spaceService.getById(spaceId);\n    ThrowUtils.throwIf(space == null, ErrorCode.NOT_FOUND_ERROR, \"空间不存在\");\n    if (!loginUser.getId().equals(space.getUserId())) {\n        throw new BusinessException(ErrorCode.NO_AUTH_ERROR, \"没有空间访问权限\");\n    }\n    // 3. 查询该空间下所有图片（必须有主色调）\n    List<Picture> pictureList = this.lambdaQuery()\n            .eq(Picture::getSpaceId, spaceId)\n            .isNotNull(Picture::getPicColor)\n            .list();\n    // 如果没有图片，直接返回空列表if (CollUtil.isEmpty(pictureList)) {\n        return Collections.emptyList();\n    }\n    // 将目标颜色转为 Color 对象Color targetColor = Color.decode(picColor);\n    // 4. 计算相似度并排序\n    List<Picture> sortedPictures = pictureList.stream()\n            .sorted(Comparator.comparingDouble(picture -> {\n                // 提取图片主色调String hexColor = picture.getPicColor();\n                // 没有主色调的图片放到最后if (StrUtil.isBlank(hexColor)) {\n                    return Double.MAX_VALUE;\n                }\n                Color pictureColor = Color.decode(hexColor);\n                // 越大越相似return -ColorSimilarUtils.calculateSimilarity(targetColor, pictureColor);\n            }))\n            // 取前 12 个\n            .limit(12)\n            .collect(Collectors.toList());\n\n    // 转换为 PictureVOreturn sortedPictures.stream()\n            .map(PictureVO::objToVo)\n            .collect(Collectors.toList());\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"QAlAdwNgpoVaZLxFkwgcxnhXnqg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"上述代码有 2 个小细节：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RSRqdoUpVoHYDNxfnCbcvUCenjd","block_type":13,"ordered":{"elements":[{"text_run":{"content":"我们提前把目标颜色从字符串转为 color 对象，而不是每计算一张图都重新转换一次对象。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"1"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"ULXLdyaXjoAocUxcLToc9kYQnEc","block_type":13,"ordered":{"elements":[{"text_run":{"content":"最后将 Picture 转为 PictureVO 时，不要调用 service 中的转换方法，会额外查询用户信息，这是没必要的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"UgapduEonoXV3oxjtZpcb6npncb","block_type":5,"heading3":{"elements":[{"text_run":{"content":"5、接口开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Ff5tdTGVQooLaSxbqUec7JAJnkg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）请求封装类 ؜SearchPictureByColorRequest，需要传入空间 id 和主色调：  ﻿               ‍               ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Vjtcdqdamoburmx9OanclxElnVc","block_type":14,"code":{"elements":[{"text_run":{"content":"@Datapublic class SearchPictureByColorRequest implements Serializable {\n\n    /**\n     * 图片主色调\n     */private String picColor;\n\n    /**\n     * 空间 id\n     */private Long spaceId;\n\n    private static final long serialVersionUID = 1L;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Xn96dH82zoot38xWhnec5nWSnsd","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）开发接口：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GgaEd3YiOolouUxilQ3cAHF4nHh","block_type":14,"code":{"elements":[{"text_run":{"content":"@PostMapping(\"/search/color\")public BaseResponse<List<PictureVO>> searchPictureByColor(@RequestBody SearchPictureByColorRequest searchPictureByColorRequest, HttpServletRequest request) {\n    ThrowUtils.throwIf(searchPictureByColorRequest == null, ErrorCode.PARAMS_ERROR);\n    String picColor = searchPictureByColorRequest.getPicColor();\n    Long spaceId = searchPictureByColorRequest.getSpaceId();\n    User loginUser = userService.getLoginUser(request);\n    List<PictureVO> result = pictureService.searchPictureByColor(spaceId, picColor, loginUser);\n    return ResultUtils.success(result);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"BbvAdZ6ExonwSBxxczdcwgb6nec","block_type":4,"heading2":{"elements":[{"text_run":{"content":"前端开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"SFeYdrzGqoLq75xSSGlcg8FPnEd","block_type":5,"heading3":{"elements":[{"text_run":{"content":"1、颜色搜索","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"EDuMdzTEGoplSSxTa8NcyStVnwb","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）选择颜色选择器组件 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"vue3-colorpicker","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fgithub.com%2Faesoper101%2Fvue3-colorpicker%3Ftab%3Dreadme-ov-file"},"strikethrough":false,"underline":false}}},{"text_run":{"content":"，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"参考文档","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Faesoper101.github.io%2Fvue3-colorpicker%2F%3Fpath%3D%2Fdocs%2Fexample-colorpicker--docs"},"strikethrough":false,"underline":false}}},{"text_run":{"content":" 来了解使用方法和参数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"V0qAdsExmoYzTkxiE1hcwgY5nCh","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"安装组件：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"ZsdxdcQsGokAKixejKhcyeMdnfy","block_type":14,"code":{"elements":[{"text_run":{"content":"npm install vue3-colorpicker","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":60,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"KcQJdS4Ivo3bv4x57trcfDN3nNf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）在空间؜详情页新增颜色搜索。因为跟其他搜索不是联动的，所以独立出来，放到搜索框下面。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Uw9VdPUowoFH8Jxqby3cia5Pn7f","block_type":14,"code":{"elements":[{"text_run":{"content":"<!-- 按颜色搜索 -->\n<a-form-item label=\"按颜色搜索\" style=\"margin-top: 16px\">\n  <color-picker format=\"hex\" @pureColorChange=\"onColorChange\" />\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</a-form-item>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"OjCMdiOrIoxJgPxSJNVcQhe4nAh","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"注意，fo؜rmat 要设置为 hex，得到十六进制的颜色值。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Y5O1d8770owDecxpexhc16BXnAc","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"3）编写切换颜色事件函数，切换颜色时会触发搜索：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CAF8drVuIohwVaxBZpvcTqPmn8y","block_type":14,"code":{"elements":[{"text_run":{"content":"const onColorChange = async (color: string) => {\n  const res = await searchPictureByColorUsingPost({\n    picColor: color,\n    spaceId: props.id,\n  })\n  if (res.data.code === 0 && res.data.data) {\n    const data = res.data.data ?? [];\n    dataList.value = data;\n    total.value = data.length;\n  } else {\n    message.error('获取数据失败，' + res.data.message)\n  }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"VplydajZRovWQuxzAvKcCo8jnKg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"效果如图：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Y233dd4tNoZIGbxkcG5c5PlOnWc","block_type":27,"image":{"align":2,"height":583,"token":"O19YbR957oLSeRxV3WJcV1Rsnbh","width":1704},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"HSNRdPHo9ovtI8xMK4fcs6Xwnof","block_type":5,"heading3":{"elements":[{"text_run":{"content":"2、展示图片主色调","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"NPfpdwvF8oSh5vxCecIcL4N7nXg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"图片详情页؜补充颜色主色调的展示，可以使用一个小色块让颜色展示效果更明显：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"PWE8dw4MRoMZhuxAKf4cVBvknBf","block_type":14,"code":{"elements":[{"text_run":{"content":"<a-descriptions-item label=\"主色调\">\n  <a-space>\n    {{ picture.picColor ?? '-' }}\n    <div\n      v-if=\"picture.picColor\"\n      :style=\"{\n        backgroundColor: toHexColor(picture.picColor),\n        width: '16px',\n        height: '16px',\n      }\"\n    />\n  </a-space>\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</a-descriptions-item>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Qmxmd31VcoimmNxtKdbc4Y0Cnxc","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"由于后端数据万象计算出的色值格式不是标准的，存在类似 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"0x080e0","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 的色值，需要转换为标准 16 进制色值：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KMkldEXX1ozBpJx3mIDcqfCnnlc","block_type":14,"code":{"elements":[{"text_run":{"content":"export function toHexColor(input) {\n  // 去掉 0x 前缀const colorValue = input.startsWith('0x') ? input.slice(2) : input\n\n  // 将剩余部分解析为十六进制数，再转成 6 位十六进制字符串const hexColor = parseInt(colorValue, 16).toString(16).padStart(6, '0')\n\n  // 返回标准 #RRGGBB 格式return `#${hexColor}`\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"WyvxdJU9qocZiqx2vJZc0qzSnLk","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"效果如图：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"FWFidMAXNoyzaFxNvDqcGxgTnZf","block_type":27,"image":{"align":2,"height":812,"token":"XzErbXY2uojBWpxADBLcAfK5n6g","width":1674},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Pk8vdZBTQoe3ZHxtPBlcywUmnpg","block_type":22,"divider":{},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"R40IdaTLxooXzHxFAg1c2jvpnMd","block_type":3,"heading1":{"elements":[{"text_run":{"content":"图片分享","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"EAPPdgYQDocgrGx4sJfctxa0nub","block_type":4,"heading2":{"elements":[{"text_run":{"content":"需求分析","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"L0GMd8jjBoeMVAxnPzrcoRhJnID","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"为了提升网站؜的用户数量，我们需要添加多个引导用户分享网站的按钮，并且确保个人用户能够更方便地通过手机访问和分享网站内容。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Fg8hdcrS9oCQ9ExwH5HcCpGVnZ5","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"支持两种分؜享形式：移动端扫码分享和复制链接分享，同时兼容移动端和 PC 端。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"LXZUd3FO1oxdgIxF29RcW6AsnHg","block_type":4,"heading2":{"elements":[{"text_run":{"content":"方案设计","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"PWqkd3wb1oDQ2Hxjo97c9g8vn8g","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"该功能的实现以前端为主，不涉及后端开发。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"P5r1dkwkBosa0cxcshUcg0Qzncg","block_type":5,"heading3":{"elements":[{"text_run":{"content":"1、通用分享组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"KANUdxbeUoRIhnxdwmjcsEgAnUf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"由于网站多؜个位置都可以触发分享。可以开发一个通用的弹窗分享组件，并在网站的各个页面（或组件）中引入。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Kae4d3gyHoQQQvxwtovcHTMgn0b","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"用户点击分؜享按钮时，分享弹窗会弹出，并展示多种不同的分享方式，引导用户顺利完成分享。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JAGVdd4qcoaoVPxuu5AclMTPnld","block_type":5,"heading3":{"elements":[{"text_run":{"content":"2、分享入口","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Z5fddmyi8oXcL3xkgZJcbWMrnTG","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"可以在图片؜详情页、个人空间的图片卡片操作栏中增加分享入口。当然也可以在主页等其他合适的位置分享~","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"VIdOdJYCXoFMjsx4gXtcCndxnOd","block_type":5,"heading3":{"elements":[{"text_run":{"content":"3、复制链接分享","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"YgxldcsOAoXLktx3ehxcPgMwnxg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"我们可以直接使用 Ant Design 的 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"可复制文本组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fantdv.com%2Fcomponents%2Ftypography-cn%23components-typography-demo-interactive"},"strikethrough":false,"underline":false}}},{"text_run":{"content":"，也可以采用第三方库如 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"copy-text-to-clipboard","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fcopy-text-to-clipboard"},"strikethrough":false,"underline":false}}},{"text_run":{"content":" 来实现复制链接功能。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HDLjdvRu7o0nQOxVWOpcyacunHc","block_type":5,"heading3":{"elements":[{"text_run":{"content":"4、移动端扫码分享","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"EopzdZmgDokmyHxkpXJco1EcnBg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"移动端扫码分享可以使用 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"组件库的 qrcode 组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fantdv.com%2Fcomponents%2Fqrcode-cn"},"strikethrough":false,"underline":false}}},{"text_run":{"content":"，也可以使用第三方的 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"qrcode 组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fqrcode"},"strikethrough":false,"underline":false}}},{"text_run":{"content":"。其原理是将分享链接转化为二维码图片，用户扫描二维码后即可访问链接。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"SDrvdcZSKohAxSxjwfGcFnjInnh","block_type":4,"heading2":{"elements":[{"text_run":{"content":"前端开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"CNq9dPDNfomQBnxL6NbcmlwCnIb","block_type":5,"heading3":{"elements":[{"text_run":{"content":"1、通用弹窗分享组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"WOtjdvkugousuVx1XJycLV6Xn6c","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）新增 ShareModal 组件，使用 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"Modal 弹窗组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fantdv.com%2Fcomponents%2Fmodal-cn"},"strikethrough":false,"underline":false}}},{"text_run":{"content":"，支持传入 title 标题和 link 分享链接属性，可以由父组件决定要分享的信息。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"SEy3dEmM8oAa9pxBLczc5tbonkg","block_type":14,"code":{"elements":[{"text_run":{"content":"<template>\n  <a-modal v-model:visible=\"visible\" title=\"分享图片\" :footer=\"false\" @cancel=\"closeModal\">\n    <h4>复制分享链接</h4>\n    <a-typography-link copyable>\n      {{ link }}\n    </a-typography-link>\n    <div style=\"margin-bottom: 16px\" />\n    <h4>手机扫码查看</h4>\n    <a-qrcode :value=\"link\" />\n  </a-modal>\n</template>\n\n<script setup lang=\"ts\">\nimport { defineProps, ref, withDefaults, defineExpose } from 'vue'\n\n/**\n * 定义组件属性类型\n */\ninterface Props {\n  title: string\n  link: string\n}\n\n/**\n * 给组件指定初始值\n */\nconst props = withDefaults(defineProps<Props>(), {\n  title: () => '分享',\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"  link: () => '","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"https://laoyujianli.com/share/yupi',","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"\n})\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</script>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"JgrXdkjNwolekHx3z60cs06Dnog","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）定义 ؜visible 变量和弹窗打开关闭的函数，用于控制弹窗是否可见：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"YcybdxbSGo88gexUVC0cQ7rdnwe","block_type":14,"code":{"elements":[{"text_run":{"content":"// 是否可见const visible = ref(false)\n\n// 打开弹窗const openModal = () => {\n  visible.value = true\n}\n\n// 关闭弹窗const closeModal = () => {\n  visible.value = false\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"G0cldd44QohiOxxxg0hciLhFnIg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"3）为了方؜便其他页面使用组件，需要暴露出 openModal 函数：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MtVCdQjRFoIuqlxe7UucPPhznLg","block_type":14,"code":{"elements":[{"text_run":{"content":"import { defineExpose } from \"vue\";\n\n// 暴露函数给父组件defineExpose({\n  openModal,\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"});","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":30,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"HYD6dfIVPoWGYoxvk6TcXlXNn0b","block_type":5,"heading3":{"elements":[{"text_run":{"content":"2、图片列表使用组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Bu0edslqBoX7FmxeX4FcJ2uBngd","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）图片列؜表组件中引入弹窗分享组件，注意要在 for 循环外引入：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Hurbd89icoKthQxH8dIcsgownKc","block_type":14,"code":{"elements":[{"text_run":{"content":"<ShareModal ref=\"shareModalRef\" :link=\"shareLink\" />","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"ZDrxdiEsgofKQxxFcDlcpsrHnmf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）编写触؜发分享的入口，点击分享图标后打开弹窗。可以移除操作栏的文字，让图片卡片看起来更精简：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MgtIdrE0Sojbz9xiQUycHMT6ntf","block_type":14,"code":{"elements":[{"text_run":{"content":"<template v-if=\"showOp\" #actions>\n  <search-outlined @click=\"(e) => doSearch(picture, e)\" />\n  <share-alt-outlined @click=\"(e) => doShare(picture, e)\" />\n  <edit-outlined @click=\"(e) => doEdit(picture, e)\" />\n  <delete-outlined @click=\"(e) => doDelete(picture, e)\" />\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</template>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"BvI4dynAKoDlIexdRFUcPTksnuI","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"3）编写分؜享函数，打开分享弹窗。注意不要硬编码分享链接的路径，而是可以获取当前的网址，代码如下：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"A6uydfXFooGlTLx4pWUcWNNOnbh","block_type":14,"code":{"elements":[{"text_run":{"content":"// 分享弹窗引用const shareModalRef = ref()\n// 分享链接const shareLink = ref<string>()\n\n// 分享const doShare = (picture: API.PictureVO, e: Event) => {\n  e.stopPropagation()\n  shareLink.value = `${window.location.protocol}//${window.location.host}/picture/${picture.id}`if (shareModalRef.value) {\n    shareModalRef.value.openModal()\n  }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":30,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"VYo7dKHjvocE9FxBmnEcok9LnRc","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"效果如图：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"DPpjdii6to6vF5xu6qbcZZLinoh","block_type":27,"image":{"align":2,"height":710,"token":"R4obbAVutooKXbxSoeGcrdginUc","width":1894},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"TWENdC00LoJp6rxMyYHcO2q2nUf","block_type":6,"heading4":{"elements":[{"text_run":{"content":"3、图片详情页使用组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"UprMdkju9oFfwAxPwM0c690Qnqg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）在免费下载按钮的右边增加分享按钮：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"NALPdU5M1ounWXxZ9SeckfsTnFg","block_type":14,"code":{"elements":[{"text_run":{"content":"<a-button type=\"primary\" ghost @click=\"doShare\">\n  分享\n  <template #icon>\n    <share-alt-outlined />\n  </template>\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</a-button>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"EVmmd7t2noV5XuxLsxOcdQf7nrc","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）分享函؜数就很简单了，复制图片列表组件的分享函数代码后，略作修改即可。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CukqdDYY6oP9tFxdUfJcxcZVngc","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"效果如图：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"FlvfdCuMKois7HxQruncCQwonPf","block_type":27,"image":{"align":2,"height":866,"token":"WCCrbuGqqorIdExcK8WczwXmnre","width":1900},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"NvPBdChtwodSEfxzd8KcDndGnRe","block_type":22,"divider":{},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"BcLMdi1Obod7BLxS1fzcJZxQnyc","block_type":3,"heading1":{"elements":[{"text_run":{"content":"图片批量管理","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"RhvZdhpP0ogc0gxTPrScdVjEnNL","block_type":4,"heading2":{"elements":[{"text_run":{"content":"需求分析","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"PXHjda55SofF2oxSkkycKDWgndg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"用户可以对私有空间内的图片进行批量修改，包括：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"AFlMd5aCNoSd0kx93gHcVofnnhd","block_type":12,"bullet":{"elements":[{"text_run":{"content":"批量修改信息：修改图片的标签和分类","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"YMTidlZ9woUnoYx8R8TcZdtEnpd","block_type":12,"bullet":{"elements":[{"text_run":{"content":"批量重命名：批量修改图片名称","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"ZwpEdiSS6oMQN7xAxGrckBlRn7g","block_type":4,"heading2":{"elements":[{"text_run":{"content":"方案设计","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"AZO3dCItVozpRkxWqG7cDNQinCP","block_type":5,"heading3":{"elements":[{"text_run":{"content":"1、批处理操作优化","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"XQuJd0YTzoRDLyxbdXEcRx8Lnee","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"批量操作的؜实现并不难，首先查询出空间内所有的图片，然后最简单的方式就是 for 循环遍历一下嘛！","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"ZoYVdLIs5o0VRCxLGnDc6t6InMb","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"但如果想让批量操作更快、更稳定地完成，我们需要注意几点：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Spztd9s25oTcXGxOo9sc3A7Xnhh","block_type":13,"ordered":{"elements":[{"text_run":{"content":"数据校验：校验参数的合法性，并且校验用户是否具有空间的访问权限，确保操作安全。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"1"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"D3sKd1BMwo03MPxG8VHcosU1nNh","block_type":13,"ordered":{"elements":[{"text_run":{"content":"查询优化：查询图片时，仅选择所需的字段（如 id 和 spaceId），减少数据库开销。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"BmS5dmxTno7RRuxvamycOZY7n1d","block_type":13,"ordered":{"elements":[{"text_run":{"content":"事务：确保批量操作具有原子性，如果有一条更新失败，那么需要对这一批操作进行回滚，避免数据不一致","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"OcrBd9nydogCloxylPkcyIWAnrf","block_type":13,"ordered":{"elements":[{"text_run":{"content":"批量更新：利用 MyBatis-Plus 提供的 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"updateBatchById","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 方法进行批量更新，而不是 for 循环多次操作数据库，从而提高性能并降低操作时间。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Kynfdr3bko1kUZxMYK1csasBnJg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"此外，如果要处理的؜数据量非常大（上千条），为了进一步优化性能，还可以结合使用线程池、分批处理和并发编程，提升大规模操作的效率。还可以通过添加日志来记录批处理操作的执行情况，提高可观测性。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"FASRdHC23oP2KHxP3yQcXIXMnKh","block_type":5,"heading3":{"elements":[{"text_run":{"content":"2、批量重命名","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Vx9hd0oCVoMWw7xr3sNcAMVrn8b","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"最简单的实现是将所有图片都修改为同一个名称，但这样不够有区分度。所以我们可以定义一个动态生成规则，允许用户在重命名时填写动态变量（占位符）。比如用户输入","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"图片_{序号}","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，其中","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"{序号}","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"就是动态变量，每个图片的序号都不同，会从 1 开始持续递增。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"QDz5dfcZFoXvTpxBnSEcNvi4nNg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"后端可以使用字符串替换方法来处理 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"{序号}","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 占位符，适用于比较简单的场景，如果动态生成规则很复杂，可以使用模板引擎技术。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"DteTdFOyLoRyTnxq9VscG6hEnBf","block_type":5,"heading3":{"elements":[{"text_run":{"content":"扩展知识 - Spring 表达式","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Y6IadddlioXqM8xsA3icOpNgnEd","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"提到动态替؜换内容，这里顺便分享一下 Spring 表达式技术。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MM0AdpGOcoC2uVx9fMrcxvJOnDd","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"Spring 表达式语言（Sp؜ring Expression Language，简称 SpEL）用于在 Spring 配置文件或 Java 代码中动态地查询和操作对象。SpEL 可以在运行时解析表达式，并执行对 Java 对象的访问、操作和计算，支持丰富的功能，如条件判断、方法调用、属性访问、集合处理、正则表达式等。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"ASEYdpOnsoCV08xNehUc2LxCnve","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"举一些语法示例：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HIBrdhW4SoEVMXx0DoNctv9xnHh","block_type":14,"code":{"elements":[{"text_run":{"content":"#{user.name}   // 访问 user 对象的 name 属性\n#{person.address.city}  // 访问嵌套对象地址中的 city 属性\n#{user.getFullName()}   // 调用 user 对象的 getFullName() 方法\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"#{user.age > 18 ? 'Adult' : 'Child'}  // 根据 age 判断是否为成年人","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"C00wd31emoBvwXxdbWwcpyzRnOf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"举例一个应؜用场景，比如缓存注解中，使用表达式根据方法参数动态生成缓存的 key：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"DSf0dvuskoqBTCxSVMScCe0xnUg","block_type":14,"code":{"elements":[{"text_run":{"content":"/**\n * 根据用户 ID 获取用户信息，并将结果缓存。\n * 使用 SpEL 动态生成缓存的 key，加入用户 ID 和请求的语言（locale）。\n *\n * @param userId 用户 ID\n * @param locale 当前语言环境（如 en, zh）\n * @return 用户信息\n */@Cacheable(value = \"users\", key = \"#userId + ':' + #locale\")public String getUserInfo(Long userId, String locale) {\n    // 模拟数据库查询\n    System.out.println(\"Fetching user info from DB...\");\n    return \"User \" + userId + \" info in \" + locale + \" language\";\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Eahbd86wwoVXoGxO7ZXc6wadneb","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"它的实现方؜式可就不是字符串替换这么简单了，而是用到了 AST 抽象语法树来对字符串进行解析，大家要对这种思路有个印象。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"LuNRdH5KLoe1qfxNla0cfWQjnjd","block_type":4,"heading2":{"elements":[{"text_run":{"content":"后端开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"TTugdm6okokkgSxgWlCcxBPNnle","block_type":5,"heading3":{"elements":[{"text_run":{"content":"1、批量修改信息","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"FMdCd40TKoMUkyxSPoQcVuXNntf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）开发请求类，接受图片 id 列表等字段：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"H7qVdlRedom6lwxRbI5cUYi7n9c","block_type":14,"code":{"elements":[{"text_run":{"content":"@Datapublic class PictureEditByBatchRequest implements Serializable {\n\n    /**\n     * 图片 id 列表\n     */private List<Long> pictureIdList;\n\n    /**\n     * 空间 id\n     */private Long spaceId;\n\n    /**\n     * 分类\n     */private String category;\n\n    /**\n     * 标签\n     */private List<String> tags;\n\n    private static final long serialVersionUID = 1L;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"E2UXd1QM5ocyBhxOSB4c8KbAn0g","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）开发批؜量修改图片服务，依次完成参数校验、空间权限校验、图片查询、批量更新操作：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MiBTdqZ0xoV6s1x4qSqc1m2jnMb","block_type":14,"code":{"elements":[{"text_run":{"content":"@Override@Transactional(rollbackFor = Exception.class)public void editPictureByBatch(PictureEditByBatchRequest pictureEditByBatchRequest, User loginUser) {\n    List<Long> pictureIdList = pictureEditByBatchRequest.getPictureIdList();\n    Long spaceId = pictureEditByBatchRequest.getSpaceId();\n    String category = pictureEditByBatchRequest.getCategory();\n    List<String> tags = pictureEditByBatchRequest.getTags();\n\n    // 1. 校验参数\n    ThrowUtils.throwIf(spaceId == null || CollUtil.isEmpty(pictureIdList), ErrorCode.PARAMS_ERROR);\n    ThrowUtils.throwIf(loginUser == null, ErrorCode.NO_AUTH_ERROR);\n    // 2. 校验空间权限Space space = spaceService.getById(spaceId);\n    ThrowUtils.throwIf(space == null, ErrorCode.NOT_FOUND_ERROR, \"空间不存在\");\n    if (!loginUser.getId().equals(space.getUserId())) {\n        throw new BusinessException(ErrorCode.NO_AUTH_ERROR, \"没有空间访问权限\");\n    }\n\n    // 3. 查询指定图片，仅选择需要的字段\n    List<Picture> pictureList = this.lambdaQuery()\n            .select(Picture::getId, Picture::getSpaceId)\n            .eq(Picture::getSpaceId, spaceId)\n            .in(Picture::getId, pictureIdList)\n            .list();\n\n    if (pictureList.isEmpty()) {\n        return;\n    }\n    // 4. 更新分类和标签\n    pictureList.forEach(picture -> {\n        if (StrUtil.isNotBlank(category)) {\n            picture.setCategory(category);\n        }\n        if (CollUtil.isNotEmpty(tags)) {\n            picture.setTags(JSONUtil.toJsonStr(tags));\n        }\n    });\n\n    // 5. 批量更新boolean result = this.updateBatchById(pictureList);\n    ThrowUtils.throwIf(!result, ErrorCode.OPERATION_ERROR);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"DBD6dzV8QoLxhJxbFgCcMupUnuh","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"💡 对于我们的؜项目来说，由于用户要处理的数据量不大，上述代码已经能够满足需求。但如果要处理大量数据，可以使用线程池 + 分批 + 并发进行优化，参考代码如下：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HBTPdMKOcoV6O6xkGkxcna80nQe","block_type":14,"code":{"elements":[{"text_run":{"content":"@Resourceprivate ThreadPoolExecutor customExecutor;\n\n/**\n * 批量编辑图片分类和标签\n */@Override@Transactional(rollbackFor = Exception.class)public void batchEditPictureMetadata(PictureBatchEditRequest request, Long spaceId, Long loginUserId) {\n    // 参数校验\n    validateBatchEditRequest(request, spaceId, loginUserId);\n\n    // 查询空间下的图片\n    List<Picture> pictureList = this.lambdaQuery()\n            .eq(Picture::getSpaceId, spaceId)\n            .in(Picture::getId, request.getPictureIds())\n            .list();\n\n    if (pictureList.isEmpty()) {\n        throw new BusinessException(ErrorCode.NOT_FOUND_ERROR, \"指定的图片不存在或不属于该空间\");\n    }\n\n    // 分批处理避免长事务int batchSize = 100;\n    List<CompletableFuture<Void>> futures = new ArrayList<>();\n    for (int i = 0; i < pictureList.size(); i += batchSize) {\n        List<Picture> batch = pictureList.subList(i, Math.min(i + batchSize, pictureList.size()));\n\n        // 异步处理每批数据\n        CompletableFuture<Void> future = CompletableFuture.runAsync(() -> {\n            batch.forEach(picture -> {\n                // 编辑分类和标签if (request.getCategory() != null) {\n                    picture.setCategory(request.getCategory());\n                }\n                if (request.getTags() != null) {\n                    picture.setTags(String.join(\",\", request.getTags()));\n                }\n            });\n            boolean result = this.updateBatchById(batch);\n            if (!result) {\n                throw new BusinessException(ErrorCode.OPERATION_ERROR, \"批量更新图片失败\");\n            }\n        }, customExecutor);\n\n        futures.add(future);\n    }\n\n    // 等待所有任务完成\n    CompletableFuture.allOf(futures.toArray(new CompletableFuture[0])).join();\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"JbNNdjH6WoEYwvxdk3kcfBW0n9f","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"此外，还可؜以多记录日志，或者让返回结果更加详细，比如更新成功了多少条数据之类的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Txwcdziu4o1xsnxdntLcl4uenYp","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"3）开发接口","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"QdsqdBBYpounWqxVJjPcCGYAnzf","block_type":14,"code":{"elements":[{"text_run":{"content":"@PostMapping(\"/edit/batch\")public BaseResponse<Boolean> editPictureByBatch(@RequestBody PictureEditByBatchRequest pictureEditByBatchRequest, HttpServletRequest request) {\n    ThrowUtils.throwIf(pictureEditByBatchRequest == null, ErrorCode.PARAMS_ERROR);\n    User loginUser = userService.getLoginUser(request);\n    pictureService.editPictureByBatch(pictureEditByBatchRequest, loginUser);\n    return ResultUtils.success(true);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"F7P9dUlV0ofKGQxTayjceYGYnpc","block_type":5,"heading3":{"elements":[{"text_run":{"content":"2、批量重命名","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"UrB3dLSSPoQb2Cx9CpTcMk79nUb","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"直接复用批؜量修改信息的方法，在这基础上做增强，补充对图片名称的修改。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"V16edvCVKopOR9xp2T3cleamn2g","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）批量编؜辑请求类 PictureEditByBatchRequest 补充字段：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"YOEOdibZ4oNecVxSHayc4Kaon2f","block_type":14,"code":{"elements":[{"text_run":{"content":"/**\n * 命名规则\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" */private String nameRule;","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"QUJMdAiCvoNdbYxyGsAc1jeqnUh","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）批量修改方法补充图片名称：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"FGqadtZGZoVHrHx4rBhcXOZSnFg","block_type":14,"code":{"elements":[{"text_run":{"content":"// 批量重命名String nameRule = pictureEditByBatchRequest.getNameRule();\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"fillPictureWithNameRule(pictureList, nameRule);","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"UfXBd3rP2ogAcixWMOcc7lCtnxg","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"编写填充图片名称的方法，使用字符串的 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"replaceAll","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 方法替换动态变量：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"L5iXdmOu3oeveIxcmnKctyTentg","block_type":14,"code":{"elements":[{"text_run":{"content":"/**\n * nameRule 格式：图片{序号}\n *\n * @param pictureList\n * @param nameRule\n */private void fillPictureWithNameRule(List<Picture> pictureList, String nameRule) {\n    if (CollUtil.isEmpty(pictureList) || StrUtil.isBlank(nameRule)) {\n        return;\n    }\n    long count = 1;\n    try {\n        for (Picture picture : pictureList) {\n            String pictureName = nameRule.replaceAll(\"\\\\{序号}\", String.valueOf(count++));\n            picture.setName(pictureName);\n        }\n    } catch (Exception e) {\n        log.error(\"名称解析错误\", e);\n        throw new BusinessException(ErrorCode.OPERATION_ERROR, \"名称解析错误\");\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":29,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"UmEmdrhN9oMflixmlqncebQxnBh","block_type":4,"heading2":{"elements":[{"text_run":{"content":"前端开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"EFKnd3clCoVbHWxTE9zcTR5jntd","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"为了实现方؜便，仅对空间详情页当前页号查询出的图片进行批量管理。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"BmlVdZFA3o7uoFxta8VcBQzfnSb","block_type":5,"heading3":{"elements":[{"text_run":{"content":"1、批量编辑弹窗表单","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"BJCGdHjIaoNVjuxy7TvcRxaynic","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）直接复؜用之前的弹窗分享组件 + 搜索图片表单组件，就能快速完成开发。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"FhTrdkBrSoLX2Bxy14bceLrtncc","block_type":12,"bullet":{"elements":[{"text_run":{"content":"表单项包括分类、标签、命名规则，还可以加一行提示语 “只对当前页面的图片生效”。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"MfAGdQ8kiomyzpx4pXVcXIcLnZc","block_type":12,"bullet":{"elements":[{"text_run":{"content":"组件属性包括 spaceId 和 pictureList，由空间详情页传入。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"QVBSdnheToFJXdxGD8dcJuTTnhh","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"代码如下：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RY0jddy0qoAN0uxo3q3cTDMAnrb","block_type":14,"code":{"elements":[{"text_run":{"content":"<template>\n  <a-modal v-model:visible=\"visible\" title=\"批量编辑图片\" :footer=\"false\" @cancel=\"closeModal\">\n    <a-typography-paragraph type=\"secondary\">* 只对当前页面的图片生效</a-typography-paragraph>\n    <!-- 表单项 -->\n    <a-form layout=\"vertical\" :model=\"formData\" @finish=\"handleSubmit\">\n      <a-form-item label=\"分类\" name=\"category\">\n        <a-auto-complete\n          v-model:value=\"formData.category\"\n          :options=\"categoryOptions\"\n          placeholder=\"请输入分类\"\n          allowClear\n        />\n      </a-form-item>\n      <a-form-item label=\"标签\" name=\"tags\">\n        <a-select\n          v-model:value=\"formData.tags\"\n          :options=\"tagOptions\"\n          mode=\"tags\"\n          placeholder=\"请输入标签\"\n          allowClear\n        />\n      </a-form-item>\n      <a-form-item label=\"命名规则\" name=\"nameRule\">\n        <a-input v-model:value=\"formData.nameRule\" placeholder=\"请输入命名规则，输入 {序号} 可动态生成\" />\n      </a-form-item>\n      <a-form-item>\n        <a-button type=\"primary\" html-type=\"submit\">提交</a-button>\n      </a-form-item>\n    </a-form>\n  </a-modal>\n</template>\n\n<script setup lang=\"ts\">\nimport { defineProps, ref, withDefaults, defineExpose, reactive, onMounted } from 'vue'\nimport {\n  editPictureByBatchUsingPost,\n  listPictureTagCategoryUsingGet,\n} from '@/api/pictureController'\nimport { message } from 'ant-design-vue'\n\n// 定义组件属性类型\ninterface Props {\n  pictureList: API.PictureVO[]\n  spaceId: number\n  onSuccess: () => void\n}\n\n// 给组件指定初始值\nconst props = withDefaults(defineProps<Props>(), {})\n\n// 控制弹窗可见性\nconst visible = ref(false)\n\n// 打开弹窗\nconst openModal = () => {\n  visible.value = true\n}\n\n// 关闭弹窗\nconst closeModal = () => {\n  visible.value = false\n}\n\n// 暴露函数给父组件\ndefineExpose({\n  openModal,\n})\n\n// 初始化表单数据\nconst formData = reactive({\n  category: '', // 分类\n  tags: [], // 标签\n  nameRule: '', // 命名规则\n})\n\nconst categoryOptions = ref<string[]>([])\nconst tagOptions = ref<string[]>([])\n\n// 获取标签和分类选项\nconst getTagCategoryOptions = async () => {\n  const res = await listPictureTagCategoryUsingGet()\n  if (res.data.code === 0 && res.data.data) {\n    // 转换成下拉选项组件接受的格式\n    tagOptions.value = (res.data.data.tagList ?? []).map((data: string) => {\n      return {\n        value: data,\n        label: data,\n      }\n    })\n    categoryOptions.value = (res.data.data.categoryList ?? []).map((data: string) => {\n      return {\n        value: data,\n        label: data,\n      }\n    })\n  } else {\n    message.error('加载选项失败，' + res.data.message)\n  }\n}\n\nonMounted(() => {\n  getTagCategoryOptions()\n})\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</script>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"Z8Kud7zP6ofTV5xWBFDcNn4nnnf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）编写提交表单的函数，调用后端批量编辑接口：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"BkUbdRZExouBVKx4QFKc5zERnie","block_type":14,"code":{"elements":[{"text_run":{"content":"// 提交表单时处理const handleSubmit = async (values: any) => {\n  if (!props.pictureList) {\n    return\n  }\n  const res = await editPictureByBatchUsingPost({\n    pictureIdList: props.pictureList.map((picture) => picture.id),\n    spaceId: props.spaceId,\n    ...values,\n  })\n  if (res.data.code === 0 && res.data.data) {\n    message.success('操作成功')\n    closeModal()\n    props.onSuccess?.()\n  } else {\n    message.error('操作失败，' + res.data.message)\n  }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"XfHGd4Z2MoIlfrxWDy1cYG9Lnwg","block_type":5,"heading3":{"elements":[{"text_run":{"content":"2、使用弹窗组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"CHQfd9UuyoDs5oxw4WucRm0YnBe","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"1）空间详情页引入弹窗组件：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"S0hRdbwGXorgudxFtcmckogjnVc","block_type":14,"code":{"elements":[{"text_run":{"content":"<BatchEditPictureModal\n  ref=\"batchEditPictureModalRef\"\n  :spaceId=\"id\"\n  :pictureList=\"dataList\"\n  :onSuccess=\"onBatchEditPictureSuccess\"\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"/>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"UWpDdmDhhoRCPnxW1ErcTMBlnwh","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"2）通过 ؜ref 获取到弹窗的引用，在批量编辑成功后要刷新图片列表数据：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RjM2d93vFog3CyxYRT2cgMR9neg","block_type":14,"code":{"elements":[{"text_run":{"content":"// 分享弹窗引用const batchEditPictureModalRef = ref()\n\n// 批量编辑成功后，刷新数据const onBatchEditPictureSuccess = () => {\n  fetchData()\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"OI9gdIhCTo5ul4xwVfxchUSsnjM","block_type":5,"heading3":{"elements":[{"text_run":{"content":"3、打开弹窗组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"IidHdiPKLoBhWIxHhC2cXvRinEf","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"在创建图片按؜钮的右侧补充 “批量编辑” 按钮，点击后打开弹窗表单：         ﻿            ‍          ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RyWDdfiXgoZh01x5BGEckK6FnAb","block_type":14,"code":{"elements":[{"text_run":{"content":"<a-button :icon=\"h(EditOutlined)\" @click=\"doBatchEdit\"> 批量编辑</a-button>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"MVhRduPEeoJbcPxEPEwcuk29nVd","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"按钮点击函数：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"IEopd4uhhoFOfNxqOWacfVzpnag","block_type":14,"code":{"elements":[{"text_run":{"content":"// 打开批量编辑弹窗const doBatchEdit = () => {\n  if (batchEditPictureModalRef.value) {\n    batchEditPictureModalRef.value.openModal()\n  }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"N3wUdhV6Houv8cxqn2wceeG0ned","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"效果如图：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"OMPFdBe60oCrcTxxaEuchmvKnSh","block_type":27,"image":{"align":2,"height":728,"token":"ZVwbbT5Mho8Kt5x8ZLecHufrneS","width":1657},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"R2SGdEKQkoXzppxKs92cPX9rnrg","block_type":22,"divider":{},"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke"},{"block_id":"J9n6dNW7UoLN5Ixl9f7cKn74nsh","block_type":2,"parent_id":"CUIedlnR5olgtSx9WhtcTV1knke","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}}],"type":"docx"}