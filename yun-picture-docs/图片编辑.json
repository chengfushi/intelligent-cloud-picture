{"nodes":[{"block_id":"WElZdF426o2o8sx0Nwyc2cIen2b","block_type":1,"children":["EAX9d5X92oVBePx5GNKcKv6FnZg","BnHedBZhOoZl2ixgA4Dc3jL9nnN","Vedxd0Pq6oYXR6xyqtIcUL4En5d","FwxJdC6FrowVeexyKmscJ8eZn4c","Afg7dLXlOoKHf1x4MHHcx41Znuh","CS62d0gEVoZVUOxUVEfcedOVnWD","SOY9dxrL1oR0nexx6cDct2DQngh","Gv9VdX71qowBwQx8qp2ccUQcnYc","TfKddG6pEoO9RXxqN6Kc4QUZn3u","B3aYdxDb3oJixmxyupwcoJSAnuf","Vz1gdwfRKoG20RxJgH0cLK8Tnjd","PJgydtAkeoF4q1xlsvmcffLinid","TA7Jdu86Wo9T11xrMxCc2ot7n8f","NuJRdOElzoBZr4xhjCHclsavnBS","Iv86dCxqZoReycx6lt0cJ24bnKb","AjGjdo26BoB6RBxQ5zjcUriNncc","UjBRdznrto3aAtxghM3c8mhJnZe","IMtcdg5tBoe85uxrzfGcsmyKn4d","MUBJdaRIHo8iwOxCvehcNFLZn5g","B7IMdxkehotIbWxwvCcc4ALln2R","AGvrdfTQ0oeXfjxXRlbcTqB9nyf","Hk7mdl2uOomfvXx0PBpcZyrzn0f","W4Wldn1yeoml3Ex3c7mcqRsTn9d","XZt5dtXD3oijAsxe91QcF41XnXg","AiPCdRSpZotKMExr8RbcJnFvnPh","QT31dhQTVoiwJ6xe5v7czpsunLd","JapQdk1vZouFyGxjOTdcZYqSnCe","GAuqdc0tioltArxLaoUcJw3unWc","MApMdHWXYoF6B6x9ZfMcPAyDnYe","V7xidGIVPo7z9exwXRDcfMDGntY","Qk05dqdKAowFccxf8F4c4VHYnXg","EymbdmMqxoCEnixbh7ech6gXnz1","WSXxdlZa5onpAMxzHdNcdyxknDe","X6qgdks4toD6A1xD0Ugcr19pnOb","ZmO3d3ItoobkdexcYBycyfodnDd","U6eNdu6ryoelERxwI1ycUHAbnfg","MyNYd7ehlouKetxdWD4cznGznje","Aos7dCt3GoUtL0xh59ncs2SQnQg","KYGNdgChqovowkx3nkucgzOAnQe","PJWadHjxHoYIRGxiyUdcwgjEnEg","JIuYdfe1popRnIxPqQTcetXjnLf","CGXMdsyZcoe1d4xp6uSc0R4onOg","Kqv2duKD7o8AIoxCH3Qc7DxHnfg","F195dPdCUobzpuxMTn9cUc12nZd","PbhMdpAu9o1CRtxOhCOcdrqBnud","FIeSdoczOoGeKNxMtFVcAnsInsU","H5TJdXOCioSsZIxD7YpcfhDknxc","A5WCdPKHpozd3BxW3SFcIf6EnCg","KsvTd6GgCosNvwx5E65ciOwjn2d","JwoNd8KHGomwcxxNkD4cBHeln2f","JSkQdMGlTo3iIfxrj8lcuD7Oni5","GrjMdDhlQoiEQ4x68gwcP6bhnCb","GCfKdwJrqoYyzPxskq3cPfT6nnd","QIWvduxXJoGHAjxujsYcqKiNnrg","T389dTHtYoy4Iqx2n4ocf6wynSc","Wv7bduYEXoGmAcx1tPNcFg30nmf","Sv1cdHAG9oXWcIxiUsdcX44ln5d","VTdxdx68MoiT73xOxfLckkH0nHd","KlUBd5TKAoEx5vxVT9icinwynwd"],"page":{"elements":[{"text_run":{"content":"图片编辑","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1}},"parent_id":""},{"block_id":"EAX9d5X92oVBePx5GNKcKv6FnZg","block_type":3,"heading1":{"elements":[{"text_run":{"content":"基础编辑","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"BnHedBZhOoZl2ixgA4Dc3jL9nnN","block_type":4,"heading2":{"elements":[{"text_run":{"content":"需求分析","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"Vedxd0Pq6oYXR6xyqtIcUL4En5d","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"在日常的图؜片管理中，用户经常需要对图片进行简单处理，比如裁剪多余部分、旋转图片、放大缩小尺寸等。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"FwxJdC6FrowVeexyKmscJ8eZn4c","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"因此，我们؜首先要引入基础图片编辑功能，帮助用户快速完成以下操作：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Afg7dLXlOoKHf1x4MHHcx41Znuh","block_type":12,"bullet":{"elements":[{"text_run":{"content":"裁剪：支持按固定比例或自由裁剪","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"CS62d0gEVoZVUOxUVEfcedOVnWD","block_type":12,"bullet":{"elements":[{"text_run":{"content":"旋转：提供顺时针、逆时针旋转功能","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"SOY9dxrL1oR0nexx6cDct2DQngh","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"这个功能非常适合上传证件照之类的场景。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Gv9VdX71qowBwQx8qp2ccUQcnYc","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"注意，该功؜能不需要限制仅在空间内才能使用，公共图库也可以支持。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"TfKddG6pEoO9RXxqN6Kc4QUZn3u","block_type":4,"heading2":{"elements":[{"text_run":{"content":"方案设计","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"B3aYdxDb3oJixmxyupwcoJSAnuf","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"图片编辑功؜能的实现以前端为主，编辑完成后通过调用现有的图片上传接口，将编辑后的图片保存至平台。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Vz1gdwfRKoG20RxJgH0cLK8Tnjd","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"具体业务流程：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"PJgydtAkeoF4q1xlsvmcffLinid","block_type":13,"ordered":{"elements":[{"text_run":{"content":"在图片上传页面，如果用户已上传图片，页面会展示“编辑图片”按钮。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"1"}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"TA7Jdu86Wo9T11xrMxCc2ot7n8f","block_type":13,"ordered":{"elements":[{"text_run":{"content":"用户点击“编辑图片”后，将打开图片编辑的弹窗组件，支持裁剪、旋转等操作。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"NuJRdOElzoBZr4xhjCHclsavnBS","block_type":13,"ordered":{"elements":[{"text_run":{"content":"用户确认编辑后，会调用图片上传接口，将编辑后的新图片保存至平台，同时更新图片信息。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"Iv86dCxqZoReycx6lt0cJ24bnKb","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"其实还有另一种设计，在؜用户每次选择本地或 URL 图片时，先不调用后端的图片上传接口，而是自动弹出图片编辑弹窗组件，编辑完后再保存。但这样做就不是 “扩展功能” 而是 “修改已有功能”，涉及到的代码改动会更多，感兴趣的同学可以尝试实现。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"AjGjdo26BoB6RBxQ5zjcUriNncc","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"💡 这个؜地方也能体现出方案设计的重要性，可以通过合适地改变业务流程，降低开发成本，并让项目更利于维护扩展。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"UjBRdznrto3aAtxghM3c8mhJnZe","block_type":4,"heading2":{"elements":[{"text_run":{"content":"前端开发","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"IMtcdg5tBoe85uxrzfGcsmyKn4d","block_type":5,"heading3":{"elements":[{"text_run":{"content":"1、图片编辑组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"MUBJdaRIHo8iwOxCvehcNFLZn5g","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"图片编辑是个比较常见的功能，一般会有现成的库可以直接用。经过调研，选用开源的 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"vue-cropper 组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fgithub.com%2Fxyxiao001%2Fvue-cropper%3Ftab%3Dreadme-ov-file%232-%25E5%25BC%2595%25E5%2585%25A5-vue-cropper"},"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"B7IMdxkehotIbWxwvCcc4ALln2R","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"1）引入组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"AGvrdfTQ0oeXfjxXRlbcTqB9nyf","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"参考官方文档引入，注意要引入 Vue3 版本的：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Hk7mdl2uOomfvXx0PBpcZyrzn0f","block_type":14,"code":{"elements":[{"text_run":{"content":"npm install vue-cropper@next","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":30,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"W4Wldn1yeoml3Ex3c7mcqRsTn9d","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"main.ts","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"中引入组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"XZt5dtXD3oijAsxe91QcF41XnXg","block_type":14,"code":{"elements":[{"text_run":{"content":"import VueCropper from 'vue-cropper';\nimport 'vue-cropper/dist/index.css'\n\napp.use(VueCropper)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":30,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"AiPCdRSpZotKMExr8RbcJnFvnPh","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"2）新建图片编辑组件ImageCropper.vue，我们要开发的组件结构包括两部分：上方为图片预览区，下方为操作栏。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"QT31dhQTVoiwJ6xe5v7czpsunLd","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"在哪里使用图片编辑组件呢？","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JapQdk1vZouFyGxjOTdcZYqSnCe","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"根据我们的方案؜设计，图片编辑不应该和任何一种上传图片的方式（本地图片 / URL 上传）进行绑定，是在上传完成后才能编辑，所以应该在图片上传页面引入。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GAuqdc0tioltArxLaoUcJw3unWc","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"先硬编码要编辑的图片 url：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MApMdHWXYoF6B6x9ZfMcPAyDnYe","block_type":14,"code":{"elements":[{"text_run":{"content":"<ImageCropper imageUrl=\"https://avatars2.githubusercontent.com/u/15681693?s=460&v=4\" />","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":30,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"V7xidGIVPo7z9exwXRDcfMDGntY","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"可以参考 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"官方 Demo","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fcodepen.io%2Fxyxiao001%2Fpen%2FyLooYKg"},"strikethrough":false,"underline":false}}},{"text_run":{"content":" 实现组件，依次完成放大、缩小、左旋、右旋操作：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Qk05dqdKAowFccxf8F4c4VHYnXg","block_type":14,"code":{"elements":[{"text_run":{"content":"<template>\n  <div class=\"image-cropper\">\n    <vue-cropper\n      ref=\"cropperRef\"\n      :img=\"imageUrl\"\n      :autoCrop=\"true\"\n      :fixedBox=\"false\"\n      :centerBox=\"true\"\n      :canMoveBox=\"true\"\n      :info=\"true\"\n      outputType=\"png\"\n    />\n    <div style=\"margin-bottom: 16px\" />\n    <!-- 图片操作 -->\n    <div class=\"image-cropper-actions\">\n      <a-space>\n        <a-button @click=\"rotateLeft\">向左旋转</a-button>\n        <a-button @click=\"rotateRight\">向右旋转</a-button>\n        <a-button @click=\"changeScale(1)\">放大</a-button>\n        <a-button @click=\"changeScale(-1)\">缩小</a-button>\n      </a-space>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue'\n\ninterface Props {\n  imageUrl?: string\n}\n\nconst props = defineProps<Props>()\n\n// 编辑器组件的引用\nconst cropperRef = ref()\n\n// 向左旋转\nconst rotateLeft = () => {\n  cropperRef.value.rotateLeft()\n}\n\n// 向右旋转\nconst rotateRight = () => {\n  cropperRef.value.rotateRight()\n}\n\n// 缩放\nconst changeScale = (num: number) => {\n  cropperRef.value.changeScale(num)\n}\n</script>\n\n<style scoped>\n.image-cropper {\n  text-align: center;\n}\n  \n.image-cropper .vue-cropper {\n  height: 400px;\n}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</style>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":66,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"EymbdmMqxoCEnixbh7ech6gXnz1","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"3）编写确认按钮","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WSXxdlZa5onpAMxzHdNcdyxknDe","block_type":14,"code":{"elements":[{"text_run":{"content":"<a-space>\n  <a-button @click=\"rotateLeft\">向左旋转</a-button>\n  <a-button @click=\"rotateRight\">向右旋转</a-button>\n  <a-button @click=\"changeScale(1)\">放大</a-button>\n  <a-button @click=\"changeScale(-1)\">缩小</a-button>\n  <a-button type=\"primary\" :loading=\"loading\" @click=\"handleConfirm\">确认</a-button>\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</a-space>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":66,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"X6qgdks4toD6A1xD0Ugcr19pnOb","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"点击后，调؜用 cropper 的 getCropBlob 函数，可以获得裁切后的文件：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"ZmO3d3ItoobkdexcYBycyfodnDd","block_type":14,"code":{"elements":[{"text_run":{"content":"// 确认裁剪\nconst handleConfirm = () => {\n  cropperRef.value.getCropBlob((blob: Blob) => {\n    // blob 为已裁切的文件\n  })\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":30,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"U6eNdu6ryoelERxwI1ycUHAbnfg","block_type":27,"image":{"align":2,"height":905,"token":"Vg5xbRdJjoeUWHxfCkBcHQjqn8r","width":1231},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"MyNYd7ehlouKetxdWD4cznGznje","block_type":5,"heading3":{"elements":[{"text_run":{"content":"2、图片编辑弹框","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"Aos7dCt3GoUtL0xh59ncs2SQnQg","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"1）把最外层从 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"div","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":" 改为 ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"a-modal","text_element_style":{"bold":false,"inline_code":true,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，注意一定要将 class 类名加在 modal 上，否则样式无法正确添加：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KYGNdgChqovowkx3nkucgzOAnQe","block_type":14,"code":{"elements":[{"text_run":{"content":"<a-modal class=\"image-cropper\" v-model:visible=\"visible\" title=\"编辑图片\" :footer=\"false\" @cancel=\"closeModal\">\n  ... 原有代码\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</a-modal>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"PJWadHjxHoYIRGxiyUdcwgjEnEg","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"2）参考图؜片分享弹窗组件，补充控制弹窗显示隐藏的相关代码，并对外暴露打开弹窗的 openModal 函数：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JIuYdfe1popRnIxPqQTcetXjnLf","block_type":14,"code":{"elements":[{"text_run":{"content":"// 是否可见const visible = ref(false)\n\n// 打开弹窗const openModal = () => {\n  visible.value = true\n}\n\n// 关闭弹窗const closeModal = () => {\n  visible.value = false\n}\n\n// 暴露函数给父组件defineExpose({\n  openModal,\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"})","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"CGXMdsyZcoe1d4xp6uSc0R4onOg","block_type":5,"heading3":{"elements":[{"text_run":{"content":"3、上传编辑后的图片","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"Kqv2duKD7o8AIoxCH3Qc7DxHnfg","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"点击确认后，需؜要上传编辑后的图片。我们可以把图片编辑组件当做是图片上传组件的一种，而不和任何一种上传图片的方式（本地图片 / URL 上传）进行绑定。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"F195dPdCUobzpuxMTn9cUc12nZd","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"1）参考图片上传؜组件的属性，给组件补充 picture 和 spaceId、onSuccess 属性：  ﻿               ‍               ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"PbhMdpAu9o1CRtxOhCOcdrqBnud","block_type":14,"code":{"elements":[{"text_run":{"content":"interface Props {\n  imageUrl?: string\n  picture?: API.PictureVO\n  spaceId?: number\n  onSuccess?: (newPicture: API.PictureVO) => void\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"FIeSdoczOoGeKNxMtFVcAnsInsU","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"2）编写上传函数؜。点击确认后将 blob 数据转换为 file 对象，然后就可以复用图片上传组件的提交函数了，上传成功后会传递新图片信息给父组件、并关闭弹窗。代码如下：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"H5TJdXOCioSsZIxD7YpcfhDknxc","block_type":14,"code":{"elements":[{"text_run":{"content":"const loading = ref<boolean>(false)\n\n// 确认裁剪const handleConfirm = () => {\n  cropperRef.value.getCropBlob((blob: Blob) => {\n    const fileName = (props.picture?.name || 'image') + '.png'const file = new File([blob], fileName, { type: blob.type })\n    // 上传图片handleUpload({ file })\n  })\n}\n\n/**\n * 上传\n * @param file\n */const handleUpload = async ({ file }: any) => {\n  loading.value = truetry {\n    const params: API.PictureUploadRequest = props.picture ? { id: props.picture.id } : {}\n    params.spaceId = props.spaceIdconst res = await uploadPictureUsingPost(params, {}, file)\n    if (res.data.code === 0 && res.data.data) {\n      message.success('图片上传成功')\n      // 将上传成功的图片信息传递给父组件\n      props.onSuccess?.(res.data.data)\n      closeModal();\n    } else {\n      message.error('图片上传失败，' + res.data.message)\n    }\n  } catch (error) {\n    message.error('图片上传失败')\n  } finally {\n    loading.value = false\n  }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"A5WCdPKHpozd3BxW3SFcIf6EnCg","block_type":5,"heading3":{"elements":[{"text_run":{"content":"4、使用图片编辑弹窗组件","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"KsvTd6GgCosNvwx5E65ciOwjn2d","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"在创建图片؜页面使用组件，可以在图片下方补充一个编辑按钮，点击编辑按钮后打开弹窗：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JwoNd8KHGomwcxxNkD4cBHeln2f","block_type":14,"code":{"elements":[{"text_run":{"content":"<div v-if=\"picture\" class=\"edit-bar\">\n  <a-button :icon=\"h(EditOutlined)\" @click=\"doEditPicture\">编辑图片</a-button>\n  <ImageCropper\n    ref=\"imageCropperRef\"\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    imageUrl=\"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"https://avatars2.githubusercontent.com/u/15681693?s=460&v=4","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"\"\n    :picture=\"picture\"\n    :spaceId=\"spaceId\"\n    :onSuccess=\"onCropSuccess\"\n  />\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"</div>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"JSkQdMGlTo3iIfxrj8lcuD7Oni5","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"编辑图片事件函数：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GrjMdDhlQoiEQ4x68gwcP6bhnCb","block_type":14,"code":{"elements":[{"text_run":{"content":"// 图片编辑弹窗引用const imageCropperRef = ref()\n\n// 编辑图片const doEditPicture = () => {\n  if (imageCropperRef.value) {\n    imageCropperRef.value.openModal()\n  }\n}\n\n// 编辑成功事件const onCropSuccess = (newPicture: API.PictureVO) => {\n  picture.value = newPicture\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":63,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"GCfKdwJrqoYyzPxskq3cPfT6nnd","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"适当优化一下 CSS 样式，增加上下边距和居中：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"QIWvduxXJoGHAjxujsYcqKiNnrg","block_type":14,"code":{"elements":[{"text_run":{"content":"#addPicturePage .edit-bar {\n  text-align: center;\n  margin: 16px 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":12,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"T389dTHtYoy4Iqx2n4ocf6wynSc","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"开发完成后؜，把 imageUrl 的值改为要编辑的图片地址：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Wv7bduYEXoGmAcx1tPNcFg30nmf","block_type":14,"code":{"elements":[{"text_run":{"content":"<ImageCropper\n  ref=\"imageCropperRef\"\n  :imageUrl=\"picture?.url\"\n  :picture=\"picture\"\n  :spaceId=\"spaceId\"\n  :onSuccess=\"onSuccess\"\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"/>","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":1,"wrap":false}},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"Sv1cdHAG9oXWcIxiUsdcX44ln5d","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"效果如图：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"VTdxdx68MoiT73xOxfLckkH0nHd","block_type":27,"image":{"align":2,"height":850,"token":"Mgw7bXewgobUMTxnZBrc5EEknic","width":1441},"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b"},{"block_id":"KlUBd5TKAoEx5vxVT9icinwynwd","block_type":2,"parent_id":"WElZdF426o2o8sx0Nwyc2cIen2b","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}}],"type":"docx"}